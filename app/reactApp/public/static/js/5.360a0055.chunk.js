(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[5],{793:function(e,t,a){"use strict";a.r(t);var n=a(9),l=a(10),o=a(11),r=a(12),c=a(0),i=a.n(c),s=a(21),m=a(24),u=(a(15),a(8)),d=a(212),p=a(213),b=a(154),h=a(155),f=a(215);var E=function(e){return i.a.createElement(b.a,{md:4},i.a.createElement("div",{class:"custom-card mb-4 shadow-sm"},i.a.createElement("center",{className:"pt-3"},i.a.createElement("h4",null,e.header)),i.a.createElement("hr",null),i.a.createElement("div",{class:"card-body"},e.description.map((function(e){return i.a.createElement("p",{className:"card-text"},e)})),i.a.createElement(s.b,{to:e.to},i.a.createElement(h.a,{className:"custom-btn"},"\u041f\u0435\u0440\u0435\u0439\u0442\u0438")))))},g=a(622),v=a(16),O=function(e){Object(o.a)(a,e);var t=Object(r.a)(a);function a(e){var l;return Object(n.a)(this,a),(l=t.call(this,e)).handleDownload=l.handleDownload.bind(Object(u.a)(l)),l.uploadDisciplines=l.uploadDisciplines.bind(Object(u.a)(l)),l}return Object(l.a)(a,[{key:"handleDownload",value:function(){fetch("/db/download",{headers:Object(v.a)()}).then((function(e){return e.json()})).then((function(e){console.log(e);var t=new Blob([JSON.stringify(e,null,2)],{type:"text/json"});Object(g.saveAs)(t,"elqueue_db.json")}))}},{key:"uploadDisciplines",value:function(){var e=document.getElementById("fileinput"),t=new FormData;t.append("file",e.files[0]),fetch("/db/upload/disciplines",{method:"POST",headers:{Authorization:"JWT "+localStorage.getItem("accesstoken")},body:t}).then((function(e){return e.json()}))}},{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.a,{className:"custom-paper bg-light p-3 col-12 col-lg-10"},i.a.createElement(p.a,null,i.a.createElement(E,{header:"\u0421\u043f\u0438\u0441\u043e\u043a \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439",description:["\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0441\u043f\u0438\u0441\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439","\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435","\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435","\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"],to:"/users"}),i.a.createElement(E,{header:"\u0421\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u043d\u044f\u0442\u0438\u0439",description:["\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0441\u043f\u0438\u0441\u043a\u0430 \u0437\u0430\u043d\u044f\u0442\u0438\u0439","\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435","\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435"],to:"/classes",className:"custom-block"}),i.a.createElement(E,{header:"\u0421\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0434\u0438\u0441\u0446\u0438\u043f\u043b\u0438\u043d",description:["\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0441\u043f\u0438\u0441\u043a\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0445 \u0434\u0438\u0441\u0446\u0438\u043f\u043b\u0438\u043d","\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435","\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435","\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"],to:"/disciplines"}),i.a.createElement(E,{header:"\u0421\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0435 \u043a\u043b\u044e\u0447\u0438",description:["\u0423\u043f\u0440\u0430\u0432\u0435\u043d\u0438\u0435 \u043a\u043b\u044e\u0447\u0430\u043c\u0438","\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435","\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435"],to:"/secretkeys"}),i.a.createElement(b.a,{md:4},i.a.createElement("div",{className:"custom-card mb-4 shadow-sm"},i.a.createElement("center",{className:"pt-3"},i.a.createElement("h4",null,"\u0418\u043c\u043f\u043e\u0440\u0442 \u0411\u0430\u0437\u044b \u0414\u0430\u043d\u043d\u044b\u0445")),i.a.createElement("hr",null),i.a.createElement("div",{className:"card-body"},i.a.createElement("input",{type:"file",id:"fileinput",className:"mb-3 p-3 custom-card bg-white",accept:".json"}),i.a.createElement("div",{className:"d-flex justify-content-between"},i.a.createElement(h.a,{className:"custom-btn btn-info",onClick:this.uploadDisciplines},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"),i.a.createElement("div",{className:"mr-0 mr-lg-3"},i.a.createElement(f.a,{src:"static/img/info.svg",width:"24"})))))),i.a.createElement(b.a,{md:4},i.a.createElement("div",{className:"custom-card mb-4 shadow-sm"},i.a.createElement("center",{className:"pt-3"},i.a.createElement("h4",null,"\u0421\u043a\u0430\u0447\u0430\u0442\u044c \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445")),i.a.createElement("hr",null),i.a.createElement("div",{className:"card-body"},i.a.createElement(h.a,{onClick:this.handleDownload,className:"custom-btn btn-info"},"JSON")))))))}}]),a}(c.Component),y=function(e){Object(o.a)(a,e);var t=Object(r.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement(d.a,{className:"p-3 col-12"},i.a.createElement(O,null))}}]),a}(c.Component),w=a(221),D=a(520),N=a.n(D),j=a(756),T=a(685),R=a.n(T),S=a(688),k=a.n(S),C=R()(k.a),x=Object.keys(j.b).map((function(e){return j.b[e]})),L={body:{emptyDataSourceMessage:"\u041d\u0435\u0442 \u0437\u0430\u043f\u0438\u0441\u0435\u0439",addTooltip:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",deleteTooltip:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",editTooltip:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c",filterRow:{filterTooltip:"\u0424\u0438\u043b\u044c\u0442\u0440"},editRow:{deleteText:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c?",cancelTooltip:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c",saveTooltip:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c"}},grouping:{placeholder:"\u041f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u043a\u043e\u043b\u043e\u043d\u043e\u043a ...",groupedBy:"\u0421\u0433\u0440\u0443\u043f\u043f\u0438\u0440\u043e\u0432\u0430\u043d \u043f\u043e:"},header:{actions:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044f"},pagination:{labelDisplayedRows:"{from}-{to} \u0438\u0437 {count}",labelRowsSelect:"\u0421\u0442\u0440\u043e\u043a",labelRowsPerPage:"\u0421\u0442\u0440\u043e\u043a \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435:",firstAriaLabel:"\u041f\u0435\u0440\u0432\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430",firstTooltip:"\u041f\u0435\u0440\u0432\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430",previousAriaLabel:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430",previousTooltip:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430",nextAriaLabel:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430",nextTooltip:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430",lastAriaLabel:"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430",lastTooltip:"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430"},toolbar:{addRemoveColumns:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c/\u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0442\u043e\u043b\u0431\u0435\u0446",nRowsSelected:"{0} \u0421\u0442\u0440\u043e\u043a \u0432\u044b\u0431\u0440\u0430\u043d\u043e",showColumnsTitle:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043a\u043e\u043b\u043e\u043d\u043a\u0438",showColumnsAriaLabel:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043a\u043e\u043b\u043e\u043d\u043a\u0438",exportTitle:"\u042d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",exportAriaLabel:"\u042d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",exportName:"\u042d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043a\u0430\u043a CSV",searchTooltip:"\u041f\u043e\u0438\u0441\u043a",searchPlaceholder:"\u041f\u043e\u0438\u0441\u043a"}};function _(e){var t=[],a=0;return e.forEach((function(e){for(var n=0;n<150;n++){var l=new Date(e.datetime);l.setDate(l.getDate()+n*e.repeatTime),t.push({id:n*a+a,title:e.disciplineName+" "+e.description,start:l,end:new Date(l+54e5)})}a++})),t}var P=function(e){return i.a.createElement(i.a.Fragment,null,"users"===e.table_name?i.a.createElement(N.a,{style:{fontFamily:"Nunito",borderRadius:20,boxShadow:"0px 3px 5px rgb(224, 224, 224)",animation:"appear .6s"},isLoading:e.isLoading,localization:L,title:e.table_name.toUpperCase(),options:{filtering:!0},columns:e.columns,data:e.data,detailPanel:function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"p-3"},i.a.createElement("table",{className:"table"},i.a.createElement("tr",null,i.a.createElement("th",null,"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435"),i.a.createElement("th",null,"\u0414\u0430\u0442\u0430")),e.telemetry.map((function(e){return i.a.createElement("tr",null,i.a.createElement("td",null,e.description),i.a.createElement("td",null,e.timestamp))})))))},editable:{onRowAdd:function(t){return new Promise((function(a){a(),e.editTable("ADD_RECORD",t)}))},onRowUpdate:function(t,a){return new Promise((function(n){n();var l=Object.assign({},a);delete l.tableData,JSON.stringify(t)!==JSON.stringify(l)&&e.editTable("UPD_RECORD",t)}))},onRowDelete:function(t){return new Promise((function(a){a(),delete Object.assign({},t).tableData,e.editTable("DEL_RECORD",t)}))}}}):i.a.createElement(N.a,{style:{fontFamily:"Nunito",borderRadius:20,boxShadow:"0px 3px 5px rgb(224, 224, 224)",animation:"appear .6s"},isLoading:e.isLoading,localization:L,title:e.table_name.toUpperCase(),options:{filtering:!0},columns:e.columns,data:e.data,editable:{onRowAdd:function(t){return new Promise((function(a){a(),e.editTable("ADD_RECORD",t)}))},onRowUpdate:function(t,a){return new Promise((function(n){n();var l=Object.assign({},a);delete l.tableData,JSON.stringify(t)!==JSON.stringify(l)&&e.editTable("UPD_RECORD",t)}))},onRowDelete:function(t){return new Promise((function(a){a(),delete Object.assign({},t).tableData,e.editTable("DEL_RECORD",t)}))}}}),"classes"===e.table_name&&e.data&&i.a.createElement("div",{className:"custom-paper p-3 col-12 mt-3"},i.a.createElement(j.a,{step:60,views:x,events:_(e.data),localizer:C})))},A=function(e){Object(o.a)(a,e);var t=Object(r.a)(a);function a(e){var l;return Object(n.a)(this,a),(l=t.call(this,e)).updateTable=l.updateTable.bind(Object(u.a)(l)),l.editTable=l.editTable.bind(Object(u.a)(l)),l.state={table:{},isLoading:!0},l}return Object(l.a)(a,[{key:"updateTable",value:function(){var e=this;this.setState({isLoading:!0}),fetch("/db/".concat(this.props.match.params.table_name),{headers:Object(v.a)()}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({isLoading:!1}),t.success?e.setState({table:{columns:t.table.columns,data:t.table.data}}):alert(t.causeOfError)}))}},{key:"editTable",value:function(e,t){var a=this;this.setState({isLoading:!0}),fetch("/db/".concat(this.props.match.params.table_name),{method:"POST",headers:Object(v.a)(),body:JSON.stringify({task:e,data:t})}).then((function(e){return e.json()})).then((function(e){console.log(e),a.setState({isLoading:!1}),e.success?a.updateTable():alert(e.causeOfError)}))}},{key:"componentDidMount",value:function(){this.updateTable(),console.log(111)}},{key:"render",value:function(){var e=this;return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.a,{className:"p-3 col-12"},"secretkeys"===this.props.match.params.table_name&&i.a.createElement(d.a,{className:"custom-paper mb-2 p-3"},i.a.createElement(w.a,{className:"mb-0",onSubmit:function(t){e.editTable("GEN_RECORD",{num:t.currentTarget.num.value}),t.preventDefault(),t.stopPropagation()}},i.a.createElement(w.a.Row,null,i.a.createElement(w.a.Group,{className:"mb-0"},i.a.createElement(w.a.Control,{name:"num",type:"number",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",min:"0",defaultValue:"0",className:"custom-textform"})),i.a.createElement(h.a,{variant:"primary",type:"submit",className:"btn custom-btn ml-3 mb-auto"},"\u0421\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c")))),i.a.createElement(P,{isLoading:this.state.isLoading,editTable:this.editTable,table_name:this.props.match.params.table_name,columns:this.state.table.columns,data:this.state.table.data})))}}]),a}(c.Component);var J=function(e){Object(o.a)(a,e);var t=Object(r.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return i.a.createElement(s.a,{basename:"/admindb"},i.a.createElement(m.d,null,i.a.createElement(m.b,{exact:!0,path:"/",component:y}),i.a.createElement(m.b,{path:"/:table_name",component:A}),i.a.createElement(m.a,{strict:!0,to:"/"})))}}]),a}(c.Component);t.default=J}}]);
//# sourceMappingURL=5.360a0055.chunk.js.map