(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{105:function(e,t,a){"use strict";var n=a(157),r=a(43),s=a(158),l=a(13),c={isAuth:localStorage.getItem("userisauth"),login:localStorage.getItem("userlogin"),role:localStorage.getItem("userrole"),id:localStorage.getItem("userid")};var o=Object(r.combineReducers)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGN_IN":return localStorage.setItem("accesstoken",t.data.access_token),localStorage.setItem("userisauth",t.data.isAuth),localStorage.setItem("userid",t.data.id),localStorage.setItem("userlogin",t.data.login),localStorage.setItem("userrole",t.data.role),delete t.data.access_token,Object(l.a)(Object(l.a)({},e),t.data);case"INFO_UPD":return void 0!==t.data.access_token&&localStorage.setItem("accesstoken",t.data.access_token),void 0!==t.data.access_token&&delete t.data.access_token,void 0!==t.data.isAuth&&localStorage.setItem("userisauth",t.data.isAuth),void 0!==t.data.id&&localStorage.setItem("userid",t.data.id),void 0!==t.data.login&&localStorage.setItem("userlogin",t.data.login),void 0!==t.data.role&&localStorage.setItem("userrole",t.data.role),Object(l.a)(Object(l.a)({},e),t.data);case"SIGN_OUT":return localStorage.removeItem("accessToken"),localStorage.removeItem("userisauth"),localStorage.removeItem("userid"),localStorage.removeItem("userlogin"),localStorage.removeItem("userrole"),{isAuth:null};case"AUTH_CHECK":default:return e}}}),i=Object(r.createStore)(o,Object(n.composeWithDevTools)(Object(r.applyMiddleware)(s.a)));t.a=i},118:function(e,t,a){},16:function(e,t,a){"use strict";var n=a(105),r=fetch;window.fetch=function(){return r.apply(this,arguments).then((function(e){return 401===e.status&&n.a.dispatch({type:"SIGN_OUT"}),e})).catch((function(e){return console.log(e)}))};t.a=function(){return{Authorization:"JWT "+localStorage.getItem("accesstoken"),"Content-Type":"application/json;charset=utf-8"}}},161:function(e,t,a){e.exports=a(206)},171:function(e,t,a){},203:function(e,t){},206:function(e,t,a){"use strict";a.r(t);var n=a(14),r=a(31),s=a.n(r),l=a(0),c=a.n(l),o=(a(171),a(9)),i=a(10),u=a(11),m=a(12),d=a(21),h=a(24),p=function(e){return function(t){t({type:"SIGN_IN",data:e})}},f=function(e){return function(t){t({type:"SIGN_OUT",data:e})}},g=function(e){return function(t){t({type:"INFO_UPD",data:e})}},b=(a(172),a(15),a(212)),E=a(13),v=a(30),O=a.n(v),y=a(41),N=a(42),j=a(8),C=a(154),k=a(221),S=a(213),w=a(216),L=a(159),I=a(225),_=a(214),x=a(215),G=a(155),A=a(220),z=a(226),T=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).containerClass=n.props.started?"float-lg-right mb-2 p-3 d-flex flex-row align-items-center justify-content-between queue-active custom-block":"float-lg-right mb-2 p-3 d-flex flex-row align-items-center justify-content-between bg-white custom-block",n.deleteQueue=n.deleteQueue.bind(Object(j.a)(n)),n}return Object(i.a)(a,[{key:"deleteQueue",value:function(){this.props.deleteQueue(this.props.user.id,this.props.id)}},{key:"render",value:function(){return c.a.createElement(b.a,{className:this.containerClass},c.a.createElement(C.a,null,c.a.createElement(S.a,null,c.a.createElement("h5",{className:"mb-0 mt-0 d-flex align-items-center"},c.a.createElement("span",{className:"badge custom-badge badge-primary mr-2 mb-1"},this.props.discipline),c.a.createElement("b",{className:"mb-1"},this.props.description))),c.a.createElement(S.a,null,c.a.createElement("div",{className:"mb-1"},c.a.createElement("span",{className:"text-muted"},"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c: "),this.props.teacher)),c.a.createElement(S.a,null,this.props.custom_start&&!this.props.started&&c.a.createElement(I.a,{placement:"bottom",overlay:c.a.createElement(_.a,null,"\u0417\u0430\u043f\u0438\u0441\u044c \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u043a\u0440\u044b\u0442\u0430 \u0441 ",this.props.start_date," \xa0 ",this.props.start_time)},c.a.createElement("div",{className:"mr-1 mr-lg-2"},c.a.createElement(x.a,{src:"static/img/important.svg",width:"24"}))),c.a.createElement(C.a,{className:"col-12 col-md-auto m-0 p-0"},c.a.createElement("span",{className:"badge custom-badge badge-info mr-1 mb-1"},this.props.date," \xa0 ",this.props.time)),this.props.groups&&this.props.groups.map((function(e,t){return c.a.createElement("span",{key:"group_"+t,className:"badge badge-secondary custom-badge mr-1 mb-1"},e)}))),c.a.createElement(S.a,{className:"ml-3"},this.props.tags&&this.props.tags.map((function(e){return c.a.createElement("span",{className:"badge badge-pill badge-info",key:"spanTag_".concat(e)},e)})))),(this.props.user.id===this.props.author||"admin"===this.props.user.role)&&this.props.delete&&c.a.createElement(A.a,{className:"mr-2 mr-lg-3"},c.a.createElement(A.a.Toggle,{variant:"success",id:"dropdown-down",className:"btn btn-light custom-btn icon-btn drop",as:"Button"},c.a.createElement(x.a,{src:"static/img/delete.svg",className:"big-icon",width:"26"})),c.a.createElement(A.a.Menu,{className:"drop-menu"},c.a.createElement(z.a.Title,{as:"h4"},c.a.createElement("b",null,"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435")),c.a.createElement(A.a.Item,{className:"drop-item mt-2",onClick:this.deleteQueue},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c ",c.a.createElement(x.a,{src:"/static/img/delete.svg",className:"big-icon",width:"20"})))),!1===this.props.id?c.a.createElement(x.a,{src:"static/img/arrowRight.svg",width:"28"}):c.a.createElement(d.b,{className:"btn custom-btn icon-btn btn-light mr-0 mr-lg-3",to:"/queue/".concat(this.props.id)},c.a.createElement(x.a,{src:"static/img/arrowRight.svg",width:"28"})))}}]),a}(l.Component),M=a(16),F=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).getTeachersList=n.getTeachersList.bind(Object(j.a)(n)),n.handleOnChange=n.handleOnChange.bind(Object(j.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(j.a)(n)),n.handleFullVerify=n.handleFullVerify.bind(Object(j.a)(n)),n.handleVerify=n.handleVerify.bind(Object(j.a)(n)),n.state={config:{teachers:[""],disciplines:[""]},values:{discipline:"",date:"".concat((new Date).getFullYear(),"-").concat(String((new Date).getMonth()+1).padStart(2,"0"),"-").concat(String((new Date).getDate()).padStart(2,"0")),time:"".concat(String((new Date).getHours()).padStart(2,"0"),":").concat(String((new Date).getMinutes()).padStart(2,"0")),teacher:"",groups:"all",description:"",custom_start:!1,start_date:"".concat((new Date).getFullYear(),"-").concat(String((new Date).getMonth()).padStart(2,"0"),"-").concat(String((new Date).getDate()).padStart(2,"0")),start_time:"".concat(String((new Date).getHours()).padStart(2,"0"),":").concat(String((new Date).getMinutes()).padStart(2,"0"))},errors:{discipline:!1,date:!1,time:!1,teacher:!1,groups:!1,description:!1,start_date:!1,start_time:!1,custom_start:!1},rules:{discipline:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0438\u0441\u0446\u0438\u043f\u043b\u0438\u043d\u0443."}],date:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0430\u0442\u0443."}],time:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0440\u0435\u043c\u044f."}],start_date:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0430\u0442\u0443."}],start_time:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0440\u0435\u043c\u044f."}],custom_start:[],teacher:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u043b\u044f."}],groups:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0433\u0440\u0443\u043f\u043f\u044b."}],description:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435."},function(e){return e.length<50||"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f 50 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432."}]},advconfig:{prevQueueId:!1,saveStudents:!1},success:!1},n}return Object(i.a)(a,[{key:"handleOnChange",value:function(e){var t=e.target.name,a=e.target.value;this.setState((function(e){return e.values[t]=a,e})),this.handleVerify(t,a)}},{key:"handleFullVerify",value:function(){var e=Object(N.a)(O.a.mark((function e(){var t=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object.entries(this.state.values).forEach((function(e){var a=Object(y.a)(e,2),n=a[0],r=a[1];"teacher"===n&&"admin"!==t.props.user.role||t.handleVerify(n,r)}));case 2:return console.log(JSON.stringify(this.state.errors)),e.abrupt("return",Object.values(this.state.errors).every((function(e){return!e})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleVerify",value:function(e,t){this.setState((function(a){var n=a.rules[e].map((function(e){var a=e(t);return!0!==a?a:null})).filter((function(e){return null!==e})).map((function(e){return c.a.createElement("p",{className:"p-0 m-0"},e)}));return a.errors[e]=0!==n.length&&n,a}))}},{key:"handleSubmit",value:function(e){var t=this;console.log(this.state.values),this.handleFullVerify().then((function(e){e&&(console.log(t.state.values),fetch("/addNewQueue",{method:"POST",headers:Object(M.a)(),body:JSON.stringify(Object(E.a)(Object(E.a)({},t.state.values),{},{user_id:t.props.user.id,advconfig:t.state.advconfig}))}).then((function(e){return e.json()})).then((function(e){console.log(e),e.success?t.setState({success:!0}):alert(e.causeOfError)})))})),e.preventDefault()}},{key:"getTeachersList",value:function(){var e=this;fetch("/config/teachers").then((function(e){return e.json()})).then((function(t){return e.setState((function(e){return{config:Object(E.a)(Object(E.a)({},e.config),{},{teachers:t}),values:Object(E.a)(Object(E.a)({},e.values),{},{teacher:e.values.teacher||t[0]})}}))}))}},{key:"getDisciplinesList",value:function(){var e=this;fetch("/config/disciplines").then((function(e){return e.json()})).then((function(t){return e.setState((function(e){return{config:Object(E.a)(Object(E.a)({},e.config),{},{disciplines:t}),values:Object(E.a)(Object(E.a)({},e.values),{},{discipline:e.values.discipline||t[0]})}}))}))}},{key:"getUrlParams",value:function(){var e=window.location.hash,t=e.slice(e.indexOf("?")+1);t=decodeURI(t);var a={};t.split("&").forEach((function(e){return a[e.split("=")[0]]=e.split("=")[1]})),this.setState((function(e){var t=e.values;return Object.keys(a).forEach((function(n){e.values.hasOwnProperty(n)&&(t[n]=a[n])})),Object(E.a)(Object(E.a)({},e),{},{values:t})})),a.hasOwnProperty("prevQueueId")&&this.setState((function(e){return e.advconfig.prevQueueId=a.prevQueueId,e}))}},{key:"componentDidMount",value:function(){"admin"===this.props.user.role&&this.getTeachersList(),this.getDisciplinesList(),this.getUrlParams()}},{key:"render",value:function(){var e=this;return this.state.success?c.a.createElement(h.a,{to:"/"}):c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a,{className:"p-3 bg-light custom-paper"},c.a.createElement("p",{className:"h5 mb-3"},"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0434\u043b\u044f \u043e\u0447\u0435\u0440\u0435\u0434\u0438"),c.a.createElement(C.a,null,c.a.createElement(k.a,{onSubmit:this.handleSubmit},c.a.createElement(S.a,{className:"mb-2"},c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridDiscipline",className:"col-12 col-lg-4"},c.a.createElement(k.a.Label,{className:"m-1"},"\u041f\u0440\u0435\u0434\u043c\u0435\u0442"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.discipline,name:"discipline",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442",className:"custom-select",as:"select",onChange:this.handleOnChange,value:this.state.values.discipline},this.state.config.disciplines.map((function(e){return c.a.createElement("option",{key:"disciplineOption_"+e},e)}))),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.discipline)),"admin"===this.props.user.role&&c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridTeacher",className:"col-12 col-lg-4"},c.a.createElement(k.a.Label,{className:"m-1"},"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.teacher,name:"teacher",as:"select",className:"custom-select",onChange:this.handleOnChange,value:this.state.values.teacher},">",this.state.config.teachers.map((function(e){return c.a.createElement("option",{key:"teacherOption_"+e},e)}))),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.teacher)),c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridGroup",className:" col-12 col-lg-4"},c.a.createElement(k.a.Label,{className:"m-1"},"\u0413\u0440\u0443\u043f\u043f\u044b"),c.a.createElement(w.a,{className:"mb-3"},c.a.createElement(w.a.Prepend,null,c.a.createElement(w.a.Text,{id:"Date-addon1",className:"custom-form"},c.a.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-people-fill",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{fillRule:"evenodd",d:"M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-5.784 6A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216zM4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"})))),c.a.createElement(L.a,{isInvalid:!!this.state.errors.groups,name:"groups",placeholder:"\u0413\u0440\u0443\u043f\u043f\u044b",className:"custom-endform",type:"text",value:this.state.values.groups,onChange:this.handleOnChange}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.groups)))),c.a.createElement(S.a,null,c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridGroup",className:" col-12 col-md-6 col-lg-4"},c.a.createElement(k.a.Label,{className:"m-1"},"\u0414\u0430\u0442\u0430 \u0437\u0430\u043d\u044f\u0442\u0438\u044f"),c.a.createElement(w.a,{className:"mb-3"},c.a.createElement(w.a.Prepend,null,c.a.createElement(w.a.Text,{id:"Date-addon1",className:"custom-form"},c.a.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-calendar-plus",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{fillRule:"evenodd",d:"M8 7a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5H6a.5.5 0 0 1 0-1h1.5V7.5A.5.5 0 0 1 8 7z"}),c.a.createElement("path",{fillRule:"evenodd",d:"M7.5 9.5A.5.5 0 0 1 8 9h2a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0v-2z"}),c.a.createElement("path",{fillRule:"evenodd",d:"M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1zm1-3a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H2z"}),c.a.createElement("path",{fillRule:"evenodd",d:"M3.5 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5zm9 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5z"})))),c.a.createElement(L.a,{isInvalid:!!this.state.errors.date,name:"date",placeholder:"Date",className:"custom-form","aria-label":"date",type:"date",value:this.state.values.date,onChange:this.handleOnChange})),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.date)),c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridTime",className:" col-12 col-md-6 col-lg-4"},c.a.createElement(k.a.Label,{className:"m-1"},"\u0412\u0440\u0435\u043c\u044f \u043d\u0430\u0447\u0430\u043b\u0430"),c.a.createElement(w.a,{className:"mb-3"},c.a.createElement(w.a.Prepend,null,c.a.createElement(w.a.Text,{id:"Time-addon1",className:"custom-form"},c.a.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-clock",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{fillRule:"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm8-7A8 8 0 1 1 0 8a8 8 0 0 1 16 0z"}),c.a.createElement("path",{fillRule:"evenodd",d:"M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"})))),c.a.createElement(L.a,{isInvalid:!!this.state.errors.time,name:"time",placeholder:"Time",className:"custom-form","aria-label":"time",type:"time",value:this.state.values.time,onChange:this.handleOnChange})),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.time))),this.state.advconfig.prevQueueId&&c.a.createElement(S.a,null,c.a.createElement(b.a,{className:"col-12"},c.a.createElement(k.a.Group,{className:"d-flex"},c.a.createElement(k.a.Check,{type:"switch",id:"custom-switch1",label:"\u041f\u0435\u0440\u0435\u043d\u0435\u0441\u0442\u0438 \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432 \u0441 \u043f\u0440\u043e\u0448\u043b\u043e\u0439 \u043e\u0447\u0435\u0440\u0435\u0434\u0438",name:"saveStudents",value:this.state.advconfig.saveStudents,onChange:function(t){var a=t.target.checked;e.setState((function(e){return e.advconfig.saveStudents=a,e}))}})))),c.a.createElement(S.a,null,c.a.createElement(b.a,{className:"col-12"},c.a.createElement(k.a.Group,{className:"d-flex"},c.a.createElement(k.a.Check,{type:"switch",id:"custom-switch2",label:"\u041e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f \u0434\u043b\u044f \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u044f \u0437\u0430\u043f\u0438\u0441\u0438",name:"custom_start",value:this.state.values.custom_start,onChange:function(t){var a=t.target.checked;e.setState((function(e){return e.values.custom_start=a,e}))}}),c.a.createElement(I.a,{placement:"bottom",overlay:c.a.createElement(_.a,null,"\u0415\u0441\u043b\u0438 \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u043e, \u0437\u0430\u043f\u0438\u0441\u044c \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0431\u0443\u0434\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430 \u0441 \u0434\u0430\u0442\u044b \u043d\u0430\u0447\u0430\u043b\u0430 \u0437\u0430\u043d\u044f\u0442\u0438\u044f")},c.a.createElement("div",{className:"ml-2 ml-lg-3"},c.a.createElement(x.a,{src:"static/img/info.svg",width:"20"})))),!0===this.state.values.custom_start&&c.a.createElement(S.a,null,c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridGroup",className:" col-12 col-md-6 col-lg-4"},c.a.createElement(k.a.Label,{className:"m-1"},"\u0414\u0430\u0442\u0430 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u044f"),c.a.createElement(w.a,{className:"mb-3"},c.a.createElement(w.a.Prepend,null,c.a.createElement(w.a.Text,{id:"Date-addon1",className:"custom-form"},c.a.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-calendar-plus",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{fillRule:"evenodd",d:"M8 7a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5H6a.5.5 0 0 1 0-1h1.5V7.5A.5.5 0 0 1 8 7z"}),c.a.createElement("path",{fillRule:"evenodd",d:"M7.5 9.5A.5.5 0 0 1 8 9h2a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0v-2z"}),c.a.createElement("path",{fillRule:"evenodd",d:"M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1zm1-3a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H2z"}),c.a.createElement("path",{fillRule:"evenodd",d:"M3.5 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5zm9 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5z"})))),c.a.createElement(L.a,{isInvalid:!!this.state.errors.start_date,name:"start_date",placeholder:"Date",className:"custom-form","aria-label":"date",value:this.state.values.start_date,onChange:this.handleOnChange,type:"date"}))),c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridTime",className:" col-12 col-md-6 col-lg-4"},c.a.createElement(k.a.Label,{className:"m-1"},"\u0412\u0440\u0435\u043c\u044f"),c.a.createElement(w.a,{className:"mb-3"},c.a.createElement(w.a.Prepend,null,c.a.createElement(w.a.Text,{id:"Time-addon1",className:"custom-form"},c.a.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-clock",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{fillRule:"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm8-7A8 8 0 1 1 0 8a8 8 0 0 1 16 0z"}),c.a.createElement("path",{fillRule:"evenodd",d:"M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"})))),c.a.createElement(L.a,{isInvalid:!!this.state.errors.start_time,name:"start_time",placeholder:"Time",className:"custom-form","aria-label":"time",value:this.state.values.start_time,onChange:this.handleOnChange,type:"time"})))))),c.a.createElement(k.a.Group,{controlId:"formGridDescription"},c.a.createElement(k.a.Label,null,"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.description,name:"description",as:"textarea",className:"custom-form",rows:"3",placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",value:this.state.values.description,onChange:this.handleOnChange}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.description)),c.a.createElement(G.a,{className:"mt-3 custom-btn",type:"submit"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043e\u0447\u0435\u0440\u0435\u0434\u044c")))),c.a.createElement(b.a,{className:"mt-3 p-3 bg-light custom-paper"},c.a.createElement(S.a,null,c.a.createElement(C.a,null,c.a.createElement("h5",null,"\u041f\u0440\u0435\u0434\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440:"),c.a.createElement(T,{id:!1,discipline:this.state.values.discipline,teacher:this.state.values.teacher,groups:this.state.values.groups.split(","),date:this.state.values.date.split("-").reverse().join(" : "),time:this.state.values.time,description:this.state.values.description,user:this.props.user,delete:!1})))))}}]),a}(l.Component),V=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{}}))(F),D=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return c.a.createElement(b.a,{className:"p-3 mt-1 mt-lg-2"},c.a.createElement(V,null))}}]),a}(l.Component),Q=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return c.a.createElement(D,null)}}]),a}(l.Component),Z=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).getTeachersList=n.getTeachersList.bind(Object(j.a)(n)),n.getDisciplinesList=n.getDisciplinesList.bind(Object(j.a)(n)),n.handleChange=n.handleChange.bind(Object(j.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(j.a)(n)),n.state={config:{teachers:[""],disciplines:[""]},selected:{discipline:"",teacher:""}},n}return Object(i.a)(a,[{key:"handleChange",value:function(e){var t=e.target.name,a=e.target.value;this.setState((function(e){return e.selected[t]=a,e}))}},{key:"handleSubmit",value:function(e){this.props.sendConfig(this.state.selected),e.preventDefault()}},{key:"getTeachersList",value:function(){var e=this;fetch("/config/teachers").then((function(e){return e.json()})).then((function(t){return e.setState((function(e){return{config:Object(E.a)(Object(E.a)({},e.config),{},{teachers:t}),selected:Object(E.a)(Object(E.a)({},e.selected),{},{teacher:t[0]})}}))})).catch(console.log)}},{key:"getDisciplinesList",value:function(){var e=this;fetch("/config/disciplines").then((function(e){return e.json()})).then((function(t){return e.setState((function(e){return{config:Object(E.a)(Object(E.a)({},e.config),{},{disciplines:t}),values:Object(E.a)(Object(E.a)({},e.selected),{},{discipline:t[0]})}}))}))}},{key:"componentDidMount",value:function(){this.props.teacher&&this.getTeachersList(),this.props.discipline&&this.getDisciplinesList()}},{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(C.a,null,c.a.createElement(k.a,{onSubmit:this.handleSubmit},c.a.createElement(S.a,{className:"mb-2"},this.props.discipline&&c.a.createElement(k.a.Group,{className:"col-12 col-lg-4"},c.a.createElement(k.a.Label,{className:"m-1"},"\u0414\u0438\u0441\u0446\u0438\u043f\u043b\u0438\u043d\u0430"),c.a.createElement(k.a.Control,{className:"custom-select",name:"discipline",as:"select",onChange:this.handleChange,value:this.state.selected.discipline},this.state.config.disciplines.map((function(e){return c.a.createElement("option",{key:"disciplineOption_"+e},e)})))),this.props.teacher&&c.a.createElement(k.a.Group,{className:"col-12 col-lg-4"},c.a.createElement(k.a.Label,{className:"m-1"},"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c"),c.a.createElement(k.a.Control,{className:"custom-select",name:"teacher",as:"select",onChange:this.handleChange,value:this.state.selected.teacher},">",this.state.config.teachers.map((function(e){return c.a.createElement("option",{key:"teacherOption_"+e},e)}))))),c.a.createElement(G.a,{className:"mt-3 custom-btn",type:"submit"},"\u041e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c"))))}}]),a}(l.Component),R=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleChange=n.handleChange.bind(Object(j.a)(n)),n.state={filterFlag:!1},n}return Object(i.a)(a,[{key:"handleChange",value:function(){this.setState({filterFlag:this.filerStatus.checked}),!1===this.filerStatus.checked&&this.props.sendConfig({})}},{key:"render",value:function(){var e=this;return c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a,{className:"p-3 bg-white custom-block col-12"},c.a.createElement(k.a.Group,null,c.a.createElement(k.a.Check,{type:"switch",id:"custom-switch",label:"\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f",ref:function(t){return e.filerStatus=t},onChange:this.handleChange})),this.state.filterFlag&&c.a.createElement(Z,{discipline:this.props.discipline,teacher:this.props.teacher,sendConfig:this.props.sendConfig})))}}]),a}(l.Component),P=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).deleteQueue=n.deleteQueue.bind(Object(j.a)(n)),n}return Object(i.a)(a,[{key:"deleteQueue",value:function(e,t){this.props.deleteQueue(e,t)}},{key:"render",value:function(){var e=this;return c.a.createElement(b.a,{className:"mt-3 p-1 bg-light col-12"},c.a.createElement(S.a,null,this.props.queuesList&&this.props.queuesList.map((function(t){return c.a.createElement(C.a,{className:"col-12 col-lg-6",key:"RowQueueContainer_".concat(t.id)},c.a.createElement(T,{key:"QueueContainer_".concat(t.id),id:t.id,discipline:t.discipline,teacher:t.teacher,description:t.description,author:t.author,date:t.date,groups:t.groups,time:t.time,index:t.index,tags:t.tags,custom_start:t.custom_start,start_date:t.start_date,start_time:t.start_time,started:t.started,user:e.props.user,deleteQueue:e.deleteQueue,delete:!0}))}))))}}]),a}(l.Component),q=a(160),J=a.n(q)()("localhost:8091");J.on("disconnect",(function(){console.log("disconnect"),console.log("waiting...")})),J.on("connection",(function(){console.log("connection")}));var K=J,$=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).updateQueuesList=n.updateQueuesList.bind(Object(j.a)(n)),n.deleteQueue=n.deleteQueue.bind(Object(j.a)(n)),n.state={queuesList:[{}],filterConfig:{discipline:"",teacher:""}},n}return Object(i.a)(a,[{key:"updateQueuesList",value:function(e){var t=this;this.setState({filterConfig:e}),fetch("/allqueues",{method:"POST",headers:Object(M.a)(),body:JSON.stringify(Object(E.a)({user_id:this.props.user.id},e))}).then((function(e){return e.json()})).then((function(e){console.log(e),t.setState({queuesList:e})}))}},{key:"deleteQueue",value:function(e,t){fetch("/deletequeue",{method:"POST",headers:Object(M.a)(),body:JSON.stringify({queue_id:t,user_id:e})}).then((function(e){return e.json()})).then(this.updateQueuesList)}},{key:"componentDidMount",value:function(){var e=this;K.on("allqueue updated",(function(t){console.log("run"),e.updateQueuesList(e.state.filterConfig)})),this.updateQueuesList(this.state.filterConfig)}},{key:"componentWillUnmount",value:function(){K.off("allqueue updated")}},{key:"render",value:function(){return c.a.createElement(b.a,{className:"p-3 mt-1 mt-lg-2 col-12"},c.a.createElement(b.a,{className:"p-2 p-lg-3 custom-paper bg-light col-12"},c.a.createElement("div",{className:"h5 ml-2 mb-3 d-flex justify-content-between"},c.a.createElement("div",null,"\u041e\u0447\u0435\u0440\u0435\u0434\u0438"),c.a.createElement(I.a,{placement:"bottom",overlay:c.a.createElement(_.a,null,"\u041e\u0447\u0435\u0440\u0435\u0434\u0438, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0443\u0436\u0435 \u043c\u043e\u0436\u043d\u043e \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f, \u0438\u043c\u0435\u044e\u0442 \u0444\u0438\u043e\u043b\u0435\u0442\u043e\u0432\u0443\u044e \u0442\u0435\u043d\u044c")},c.a.createElement("div",{className:"mr-0 mr-lg-3"},c.a.createElement(x.a,{src:"static/img/info.svg",width:"24"})))),c.a.createElement(R,{discipline:!0,teacher:"admin"===this.props.user.role,sendConfig:this.updateQueuesList}),c.a.createElement(P,{queuesList:this.state.queuesList,user:this.props.user,deleteQueue:this.deleteQueue})))}}]),a}(l.Component),U=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{onSignOut:function(t){e(f(t))}}}))($),B=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return c.a.createElement(U,null)}}]),a}(l.Component),H=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={configs:{discipline:"",groups:[""],date:"",time:"",teacher:"",description:"",custom_start:!1,start_date:"",start_time:""}},n.updateInfo=n.updateInfo.bind(Object(j.a)(n)),n.redirectWithConfigs=n.redirectWithConfigs.bind(Object(j.a)(n)),n}return Object(i.a)(a,[{key:"updateInfo",value:function(){var e=this;fetch("/queueInfo",{method:"POST",headers:Object(M.a)(),body:JSON.stringify({id:this.props.curr_id})}).then((function(e){return e.json()})).then((function(t){e.setState({configs:t})}))}},{key:"redirectWithConfigs",value:function(){var e=this.state.configs;e.prevQueueId=this.props.curr_id;var t=Object.entries(e).map((function(e){var t=Object(y.a)(e,2),a=t[0],n=t[1];return"".concat(a,"=").concat(n)})).join("&");window.location.hash="/addqueue?"+t}},{key:"componentDidMount",value:function(){this.updateInfo()}},{key:"componentDidUpdate",value:function(e){e.curr_id!==this.props.curr_id&&this.updateInfo()}},{key:"render",value:function(){return c.a.createElement(A.a,{as:"Container",className:"col-12 col-lg-6 p-0 m-0"},c.a.createElement(A.a.Toggle,{as:"div",className:"p-2 p-lg-4 col-12 drop"},c.a.createElement(b.a,{className:"custom-paper p-3 bg-light click-reaction"},c.a.createElement(S.a,null,c.a.createElement(C.a,{className:"col-2 col-lg-2 d-flex justify-content-end align-items-start"},c.a.createElement(x.a,{className:"mt-2 custom-queue-icon",src:"static/img/queue.svg",width:"90%"})),c.a.createElement(C.a,{className:"col-10 col-lg-5"},c.a.createElement(S.a,null,c.a.createElement(C.a,{className:"col-12"},c.a.createElement("div",{className:"mt-2"},c.a.createElement("div",{className:"mb-2 text-secondary font-weight-bold"},this.state.configs.date," ",this.state.configs.time),c.a.createElement("h5",{className:"mb-0 d-flex align-items-center"},c.a.createElement("span",{className:"badge custom-badge badge-primary mr-2 mb-1"},this.state.configs.discipline),c.a.createElement("b",{className:"mb-1"},this.state.configs.description)))))),c.a.createElement(C.a,{className:"col-10 col-lg-5 d-flex flex-column justify-content-center"},c.a.createElement(S.a,null,c.a.createElement(C.a,{className:"col-12 d-flex"},c.a.createElement("div",{className:"text-muted mr-2"},"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c:"),this.state.configs.teacher)),c.a.createElement(S.a,null,c.a.createElement(C.a,{className:"col-12  d-flex"},c.a.createElement("div",{className:"text-muted mr-2"},"\u0413\u0440\u0443\u043f\u043f\u044b:"),this.state.configs.groups.join(", "))),this.state.configs.custom_start&&c.a.createElement(S.a,null,c.a.createElement(C.a,{className:"col-12  d-flex"},c.a.createElement("div",{className:"text-muted mr-2"},"\u041e\u0442\u043a\u0440\u044b\u0442\u0438\u0435:"),c.a.createElement("b",{className:"text-info"},this.state.configs.start_date," ",this.state.configs.start_time))))))),"student"!==this.props.user.role&&c.a.createElement(A.a.Menu,{className:"drop-menu ml-4"},c.a.createElement(z.a.Title,{as:"h4"},c.a.createElement("b",null,"\u041e\u043f\u0446\u0438\u0438")),c.a.createElement(A.a.Item,{className:"drop-item mt-2",onClick:this.redirectWithConfigs},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u043f\u0438\u044e ",c.a.createElement(x.a,{src:"/static/img/copy.svg",className:"big-icon ml-1",width:"24"}))))}}]),a}(l.Component),W=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{onSignOut:function(t){e(f(t))}}}))(H),Y=a(217);a(219);var X=function(e){function t(t){console.log(t),fetch("/queue/action",{method:"POST",headers:Object(M.a)(),body:JSON.stringify({action:t,queue_id:window.location.hash.split("/")[2],record_id:e.record_id})}).then((function(e){return e.json()})).then((function(t){e.updateStudentList()}))}return c.a.createElement(c.a.Fragment,null,e.allowMove&&c.a.createElement(A.a,{className:"mr-2"},c.a.createElement(A.a.Toggle,{variant:"success",id:"dropdown-down",className:"btn btn-light custom-btn icon-btn drop",as:"Button"},c.a.createElement(x.a,{src:"static/img/arrowBoth.svg",width:"28"})),c.a.createElement(A.a.Menu,{className:"drop-menu"},c.a.createElement(A.a.Item,{className:"drop-item",onClick:function(){return t(1)}},"\u0412 \u043d\u0430\u0447\u0430\u043b\u043e ",c.a.createElement(x.a,{src:"/static/img/arrowTop.svg",width:"25"})),c.a.createElement(A.a.Item,{className:"drop-item",onClick:function(){return t(2)}},"\u0412\u044b\u0448\u0435 \u043d\u0430 1 ",c.a.createElement(x.a,{src:"/static/img/arrowUp.svg",width:"20"})),c.a.createElement(A.a.Item,{className:"drop-item",onClick:function(){return t(3)}},"\u041d\u0438\u0436\u0435 \u043d\u0430 1 ",c.a.createElement(x.a,{src:"/static/img/arrowDown.svg",width:"20"})),c.a.createElement(A.a.Item,{className:"drop-item",onClick:function(){return t(4)}},"\u0412 \u043a\u043e\u043d\u0435\u0446 ",c.a.createElement(x.a,{src:"/static/img/arrowLast.svg",width:"23"})))),e.allowDelete&&c.a.createElement(A.a,{className:"mr-2"},c.a.createElement(A.a.Toggle,{variant:"success",id:"dropdown-down",className:"btn btn-light custom-btn icon-btn drop",as:"Button"},c.a.createElement(x.a,{src:"static/img/delete.svg",className:"big-icon",width:"26"})),c.a.createElement(A.a.Menu,{className:"drop-menu"},c.a.createElement(z.a.Title,{as:"h4"},c.a.createElement("b",null,"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435")),c.a.createElement(A.a.Item,{className:"drop-item mt-2",onClick:function(){return t(5)}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c ",c.a.createElement(x.a,{src:"/static/img/delete.svg",className:"big-icon",width:"20"})))))},ee=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).action=n.action.bind(Object(j.a)(n)),n.updateCommentList=n.updateCommentList.bind(Object(j.a)(n)),n.handleOnChange=n.handleOnChange.bind(Object(j.a)(n)),n.state={commentValue:"",comments:[]},console.log("constr"),n}return Object(i.a)(a,[{key:"updateCommentList",value:function(){var e=this;fetch("/comments",{method:"POST",headers:Object(M.a)(),body:JSON.stringify({queue_id:window.location.hash.split("/")[2],record_id:this.props.id})}).then((function(e){return e.json()})).then((function(t){e.setState({comments:t}),console.log(e.state.comments)}))}},{key:"action",value:function(){fetch("/queue/comment",{method:"POST",headers:Object(M.a)(),body:JSON.stringify({queue_id:window.location.hash.split("/")[2],record_id:this.props.id,value:this.state.commentValue,author:this.props.user.id})}).then((function(e){return e.json()})).then(this.updateCommentList)}},{key:"componentDidMount",value:function(){this.updateCommentList()}},{key:"handleOnChange",value:function(e){var t=e.target.value;this.setState({commentValue:t})}},{key:"render",value:function(){return console.log("0-----------0"),c.a.createElement(b.a,{className:"bg-white col-12 custom-block queue-element p-2 mb-2"},c.a.createElement(S.a,null,c.a.createElement(C.a,{className:"col-12 col-lg-4 d-flex align-items-center"},c.a.createElement("div",null,c.a.createElement("span",{className:"badge custom-badge badge-primary mr-1 mr-lg-3 ml-0 ml-lg-2"},c.a.createElement("big",{className:"font-weight-bold"},this.props.index||"0")),this.props.group&&c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"badge custom-badge badge-info mr-1 mr-lg-2"},c.a.createElement("big",{className:"font-weight-lighter"},this.props.group))),c.a.createElement("big",{className:"align-middle"},this.props.name," ",this.props.surname))),c.a.createElement(C.a,{className:"col-auto mt-2 mb-2 mt-lg-0 mb-lg-0 col-lg-4 d-flex align-items-center"},c.a.createElement("big",{className:"ml-2"},c.a.createElement("b",null,this.props.task))),c.a.createElement(C.a,{className:"col-12 col-lg-3 d-flex justify-content-start align-items-center"},c.a.createElement(A.a,{className:"mr-1 mr-lg-2"},c.a.createElement(A.a.Toggle,{variant:"success",id:"dropdown-down",className:"btn btn-light custom-btn icon-btn drop",as:"Button"},c.a.createElement(x.a,{src:"static/img/dots.svg",className:"big-icon",width:"26"})),c.a.createElement(A.a.Menu,{className:"drop-menu"},c.a.createElement(b.a,null,c.a.createElement("div",null,c.a.createElement("span",{className:"text-muted"},"\u0414\u0430\u0442\u0430:")," ",this.props.date),c.a.createElement("div",null,c.a.createElement("span",{className:"text-muted"},"\u041a\u043e\u043b-\u0432\u043e \u0437\u0430\u043f\u0438\u0441\u0435\u0439:")," ",this.props.count),c.a.createElement("div",null,c.a.createElement("span",{className:"text-muted"},"\u041b\u043e\u0433\u0438\u043d:")," ",this.props.login)))),("student"!==this.props.user.role||this.props.user.id===this.props.author)&&c.a.createElement(A.a,{className:"mr-1 mr-lg-2"},c.a.createElement(A.a.Toggle,{variant:"success",id:"dropdown-down",className:"btn btn-light custom-btn icon-btn drop",as:"Button"},c.a.createElement(x.a,{src:"static/img/comments.svg",className:"big-icon",width:"26"})),c.a.createElement(A.a.Menu,{className:"comments"},c.a.createElement(b.a,{className:"mt-2"},this.state.comments&&this.state.comments.map((function(e){return c.a.createElement("div",{className:"mb-1 custom-card border bg-light p-2"},c.a.createElement("div",{className:"text-info m-0 p-0"},e.author),c.a.createElement("div",null,e.text),c.a.createElement("small",{className:"text-muted"},e.date))})),c.a.createElement("hr",null),c.a.createElement(k.a.Group,{controlId:"formGridDescription",className:"d-flex align-items-center"},c.a.createElement(k.a.Control,{name:"description",as:"textarea",className:"custom-form locked-height form-control-sm",rows:"2",placeholder:"\u041e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439...",value:this.state.taskValue,onChange:this.handleOnChange}),c.a.createElement(G.a,{className:"ml-2 btn btn-light custom-btn icon-btn",onClick:this.action},c.a.createElement(x.a,{src:"static/img/send.svg",className:"big-icon",width:"28"})))))),c.a.createElement(X,{record_id:this.props.id,updateStudentList:this.props.updateStudentList,allowDelete:"student"!==this.props.user.role||this.props.user.id===this.props.author,allowMove:"student"!==this.props.user.role}))))}}]),a}(l.Component),te=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{onSignOut:function(t){e(f(t))}}}))(ee),ae=a(108),ne=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onDragEnd=function(e){e.destination&&(console.log(e),console.log("item id",e.draggableId),console.log("from",e.source.index),console.log("to",e.destination.index),n.moved(e.draggableId,e.destination.index))},n.state={loading:!1},n.onDragEnd=n.onDragEnd.bind(Object(j.a)(n)),n}return Object(i.a)(a,[{key:"moved",value:function(e,t){var a=this;this.setState({loading:!0}),fetch("/queue/action",{method:"POST",headers:Object(M.a)(),body:JSON.stringify({action:6,queue_id:window.location.hash.split("/")[2],record_id:e,to:t})}).then((function(e){a.props.updateStudentList(),a.setState({loading:!1})}))}},{key:"render",value:function(){var e=this;return this.state.loading?c.a.createElement(b.a,{className:"col-12 d-flex justify-content-center align-items-center"},c.a.createElement(Y.a,{animation:"border",role:"status"},c.a.createElement("span",{className:"sr-only"},"Loading..."))):c.a.createElement(b.a,{className:"p-3 col-12"},c.a.createElement(ae.a,{onDragEnd:this.onDragEnd},c.a.createElement(ae.c,{droppableId:"droppable"},(function(t){return c.a.createElement(C.a,Object.assign({},t.droppableProps,{ref:t.innerRef}),e.props.studentList&&e.props.studentList.map((function(t,a){return c.a.createElement(ae.b,{key:t.id,draggableId:t.id,index:a},(function(a){return c.a.createElement(S.a,Object.assign({ref:a.innerRef},a.draggableProps,a.dragHandleProps),c.a.createElement(te,{key:"QueueContainer_".concat(t.id),id:t.id,name:t.name,surname:t.surname,login:t.login,task:t.task,index:t.index,tags:t.tags,author:t.author,group:t.group,count:t.count,date:t.date,updateStudentList:e.updateStudentList}))}))})),t.placeholder)}))))}}]),a}(l.Component);var re=function(e){return c.a.createElement(b.a,{className:"p-3 col-12"},c.a.createElement(C.a,null,e.studentList&&e.studentList.map((function(t){return c.a.createElement(S.a,{key:"RowQueueContainer_".concat(t.id)},c.a.createElement(te,{key:"QueueContainer_".concat(t.id),id:t.id,name:t.name,surname:t.surname,login:t.login,task:t.task,index:t.index,tags:t.tags,author:t.author,group:t.group,count:t.count,date:t.date,updateStudentList:e.updateStudentList}))}))))},se=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).joinQueue=n.joinQueue.bind(Object(j.a)(n)),n.handleOnChange=n.handleOnChange.bind(Object(j.a)(n)),n.taskCheck=n.taskCheck.bind(Object(j.a)(n)),n.state={taskValue:"",taskError:!1,taskRule:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435."},function(e){return e.length>2||"\u041c\u0438\u043d\u0438\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u0430: 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0430"}]},n}return Object(i.a)(a,[{key:"joinQueue",value:function(){var e=Object(N.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.taskCheck(this.state.taskValue);case 2:this.state.taskError||this.props.joinQueue(this.props.user.id,this.state.taskValue);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleOnChange",value:function(e){var t=e.target.value;this.taskCheck(t),this.setState({taskValue:t})}},{key:"taskCheck",value:function(e){this.setState((function(t){var a=t.taskRule.map((function(t){var a=t(e);return!0!==a?a:null})).filter((function(e){return null!==e})).map((function(e){return c.a.createElement("p",{className:"p-0 m-0"},e)}));return t.taskError=0!==a.length&&a,t}))}},{key:"render",value:function(){return c.a.createElement(b.a,{className:"p-2 p-lg-4 col-12 col-lg-6"},c.a.createElement(b.a,{className:"p-3 custom-paper bg-light"},this.props.started?c.a.createElement(S.a,null,c.a.createElement(C.a,{className:"d-flex align-items-end col-12 col-lg-3"},c.a.createElement("h5",null," \u0417\u0430\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f ")),c.a.createElement(C.a,{className:"d-flex flex-row align-items-end col-12 col-lg-7"},c.a.createElement(k.a.Label,{className:"mr-3 d-none d-lg-block"}," \u0420\u0430\u0431\u043e\u0442\u0430: "),c.a.createElement(k.a.Group,{controlId:"exampleForm.ControlSelect2",className:"p-0 m-0 w-100"},c.a.createElement(k.a.Control,{isInvalid:!!this.state.taskError,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435",className:"custom-textform",type:"text",value:this.state.taskValue,onChange:this.handleOnChange}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.taskError))),c.a.createElement(C.a,{className:"d-flex align-items-center justify-content-center mt-2 mt-lg-0"},c.a.createElement(A.a,{className:"mr-2 mr-lg-3"},c.a.createElement(A.a.Toggle,{variant:"success",id:"dropdown-down",className:"btn btn-light custom-btn icon-btn drop",as:"Button"},c.a.createElement(x.a,{src:"static/img/plusBlack.svg",className:"big-icon",width:"28"})),c.a.createElement(A.a.Menu,{className:"drop-menu"},c.a.createElement(z.a.Title,{as:"h4"},c.a.createElement("b",null,"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435")),c.a.createElement(A.a.Item,{className:"drop-item mt-2",onClick:this.joinQueue},"\u0417\u0430\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f ",c.a.createElement(x.a,{src:"/static/img/accept.svg",width:"24"})))))):c.a.createElement(S.a,null,c.a.createElement(C.a,{className:"d-flex align-items-end col-12"},c.a.createElement("h5",null," \u0417\u0430\u043f\u0438\u0441\u044c \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0435\u0449\u0435 \u043d\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430 ")))))}}]),a}(l.Component),le=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{}}))(se),ce=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).updateStudentList=n.updateStudentList.bind(Object(j.a)(n)),n.joinQueue=n.joinQueue.bind(Object(j.a)(n)),n.state={studentList:[],started:!1},n}return Object(i.a)(a,[{key:"joinQueue",value:function(e,t){fetch("/joinqueue",{method:"POST",headers:Object(M.a)(),body:JSON.stringify({user_id:e,task:t,queue_id:this.props.curr_id})}).then((function(e){return e.json()})).then((function(e){console.log(e),"false"===e.success&&alert(e.causeOfError)})).then(this.updateStudentList)}},{key:"updateStudentList",value:function(){var e=this;fetch("/queuestudents",{method:"POST",headers:Object(M.a)(),body:JSON.stringify({id:this.props.curr_id})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({studentList:t.list,started:t.started})}))}},{key:"componentDidMount",value:function(){var e=this;K.emit("join",{room:this.props.curr_id}),K.on("queue updated",(function(t){e.updateStudentList()})),this.updateStudentList()}},{key:"componentDidUpdate",value:function(e){K.emit("leave",{room:this.props.curr_id}),K.off("queue updated"),e.curr_id!==this.props.curr_id&&this.updateStudentList()}},{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(le,{joinQueue:this.joinQueue,started:this.state.started}),c.a.createElement(b.a,{className:"p-2 p-lg-4 col-12"},c.a.createElement(b.a,{className:"p-3 custom-paper bg-light col-12"},c.a.createElement(S.a,null,"student"===this.props.user.role&&c.a.createElement(re,{studentList:this.state.studentList,updateStudentList:this.updateStudentList}),("admin"===this.props.user.role||"teacher"===this.props.user.role)&&c.a.createElement(ne,{studentList:this.state.studentList,updateStudentList:this.updateStudentList})))))}}]),a}(l.Component),oe=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{onSignOut:function(t){e(f(t))}}}))(ce),ie=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return c.a.createElement(b.a,{className:"p-3 col-12"},c.a.createElement(S.a,null,c.a.createElement(W,{curr_id:this.props.curr_id}),c.a.createElement(oe,{curr_id:this.props.curr_id})))}}]),a}(l.Component),ue=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return c.a.createElement(ie,{curr_id:this.props.match.params.curr_id})}}]),a}(l.Component),me=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).updateStats=n.updateStats.bind(Object(j.a)(n)),n.formatSeconds=n.formatSeconds.bind(Object(j.a)(n)),n.state={statsInfo:{avgQueueTime:"",avgRecords:"",avgRecordTime:"",error:!1},filterConfig:{discipline:"",teacher:""}},n}return Object(i.a)(a,[{key:"updateStats",value:function(e){var t=this;this.setState({filterConfig:e}),fetch("/stats",{method:"POST",headers:Object(M.a)(),body:JSON.stringify(Object(E.a)({},e))}).then((function(e){return e.json()})).then((function(e){var a=Object(E.a)({},e);a.avgQueueTime=t.formatSeconds(e.avgQueueTime),a.avgRecordTime=t.formatSeconds(e.avgRecordTime),a.avgRecords=Math.round(e.avgRecords),t.setState(Object(E.a)(Object(E.a)({},t.state),{},{statsInfo:a}))}))}},{key:"formatSeconds",value:function(e){e=Math.round(e);var t=Math.floor(e/60/60),a=Math.floor(e/60)-60*t,n=e%60;return[t.toString().padStart(2,"0"),a.toString().padStart(2,"0"),n.toString().padStart(2,"0")].join(":")}},{key:"componentDidMount",value:function(){this.updateStats(this.state.filterConfig)}},{key:"render",value:function(){return c.a.createElement(b.a,{className:"p-3 col-12"},c.a.createElement(R,{discipline:!0,teacher:!0,sendConfig:this.updateStats}),!0===this.state.statsInfo.error&&c.a.createElement("div",{className:"p-3 col-12 mt-3"},c.a.createElement("div",{className:"h4"}," \u0414\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e ")),c.a.createElement("div",{className:"p-3 col-12 mt-3 custom-paper"},c.a.createElement("div",{className:"h5"},c.a.createElement("b",null,"\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439:")," ",this.state.statsInfo.avgQueueTime),c.a.createElement("div",{className:"h5"},c.a.createElement("b",null,"\u0421\u0440\u0435\u0434\u043d\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043a\u0440\u044b\u0442\u044b\u0445 \u0437\u0430\u043f\u0438\u0441\u0435\u0439:")," ",this.state.statsInfo.avgRecords),c.a.createElement("div",{className:"h5"},c.a.createElement("b",null,"\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0434\u0430\u0447\u0438:")," ",this.state.statsInfo.avgRecordTime)))}}]),a}(l.Component),de=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return c.a.createElement(b.a,{className:"mb-3 p-0 col-12"},c.a.createElement(b.a,{className:"custom-paper p-3 bg-light"},c.a.createElement(S.a,null,c.a.createElement(C.a,{className:"col-10 col-lg-8"},c.a.createElement(S.a,null,c.a.createElement(C.a,{className:"col-12"},c.a.createElement("div",{className:"mt-2 mb-2"},c.a.createElement("h4",{className:"mb-0"},this.props.userInfo.name," ",this.props.userInfo.surname," ",this.props.userInfo.patronymic),c.a.createElement("div",{className:"text-muted"},this.props.userInfo.login)))),c.a.createElement(S.a,{className:"mb-2"},c.a.createElement(C.a,{className:"col-12 d-flex"},c.a.createElement("div",{className:"text-muted mr-2"},"\u0420\u043e\u043b\u044c:"),this.props.userInfo.role),"student"===this.props.user.role&&c.a.createElement(C.a,{className:"col-12  d-flex"},c.a.createElement("div",{className:"text-muted mr-2"},"\u0413\u0440\u0443\u043f\u043f\u0430:"),this.props.userInfo.group)),c.a.createElement(S.a,null,c.a.createElement(C.a,{className:"col-12  d-flex mb-1"},c.a.createElement(x.a,{src:"static/img/profile/github.png",width:"20",height:"20"}),c.a.createElement("div",{className:"text-muted mr-2 ml-1"},"Github:"),this.props.userInfo.GitID),c.a.createElement(C.a,{className:"col-12 d-flex"},c.a.createElement(x.a,{src:"static/img/profile/moodle.png",className:"",width:"24",height:"24"}),c.a.createElement("div",{className:"text-muted mr-2"},"oodle:"),this.props.userInfo.moodleID))),c.a.createElement(C.a,{className:"col-2 col-lg-4"},c.a.createElement(x.a,{className:"mt-2",src:"static/img/profile/avatar.png",width:"90%"})))))}}]),a}(l.Component),he=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{}}))(de),pe=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleClick=n.handleClick.bind(Object(j.a)(n)),n.sendConfig=n.sendConfig.bind(Object(j.a)(n)),n.state={queuesList:[],queuesFlag:!1},n}return Object(i.a)(a,[{key:"handleClick",value:function(){this.setState((function(e){return{queuesFlag:!e.queuesFlag}}))}},{key:"sendConfig",value:function(e){var t=this;fetch("/profilequeues",{method:"POST",headers:Object(M.a)(),body:JSON.stringify(Object(E.a)(Object(E.a)({},e),{},{login:this.props.curr_login,role:this.props.user.role}))}).then((function(e){return e.json()})).then((function(e){console.log(e),t.setState({queuesList:e})}))}},{key:"deleteQueue",value:function(e,t){fetch("/deletequeue",{method:"POST",headers:Object(M.a)(),body:JSON.stringify({queue_id:t,user_id:e})}).then((function(e){return e.json()})).then(this.componentDidMount)}},{key:"componentDidMount",value:function(){this.sendConfig({teacher:""})}},{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a,{className:"p-0"},c.a.createElement(b.a,{className:"p-3 bg-light custom-paper"},c.a.createElement(S.a,null,c.a.createElement(C.a,null,c.a.createElement("h5",{className:"mb-1"},"\u0421\u043f\u0438\u0441\u043e\u043a \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439"))),c.a.createElement(S.a,{className:"p-1 p-lg-3"},c.a.createElement(R,{discipline:!0,teacher:"admin"===this.props.user.role,sendConfig:this.sendConfig}),c.a.createElement(P,{queuesList:this.state.queuesList,user:this.props.user,deleteQueue:this.deleteQueue})))))}}]),a}(l.Component),fe=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{onSignOut:function(t){e(f(t))}}}))(pe);var ge=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{onSignOut:function(t){e(f(t))}}}))((function(e){return c.a.createElement(b.a,{className:"mb-3 p-0 col-12"},c.a.createElement(b.a,{className:"custom-paper p-3 bg-light"},c.a.createElement("p",{className:"h5 mb-3 text-center"},"\u041f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f"),c.a.createElement(S.a,null,c.a.createElement(C.a,{className:"col-12 m-2 d-flex flex-column align-items-center"},c.a.createElement(d.b,{className:"mr-3",to:"/enqueue"},c.a.createElement("div",{className:"btn custom-btn  p-2"},"C\u043f\u0438\u0441\u043e\u043a \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439",c.a.createElement(x.a,{src:"static/img/list.svg",width:"26",className:"ml-3 custom-icon"})))),c.a.createElement(C.a,{className:"col-12 m-2 d-flex flex-column align-items-center"},c.a.createElement(d.b,{className:"mr-3",to:"/profile/editor"},c.a.createElement("div",{className:"btn custom-btn p-2"},"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",c.a.createElement(x.a,{src:"static/img/edit.svg",width:"26",className:"ml-3 custom-icon"})))),c.a.createElement(C.a,{className:"col-12 m-2 d-flex flex-column align-items-center"},c.a.createElement(d.b,{onClick:e.onSignOut,to:"/auth/signin"},c.a.createElement("div",{className:"btn custom-btn  p-2"},"\u0412\u044b\u0439\u0442\u0438",c.a.createElement(x.a,{src:"static/img/logout.svg",width:"26",className:"ml-3 custom-icon"})))))))})),be=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).getInfo=n.getInfo.bind(Object(j.a)(n)),n.state={userInfo:{login:"",role:"",name:"",patronymic:"",surname:"",GitID:"",moodleID:"",group:""}},n}return Object(i.a)(a,[{key:"getInfo",value:function(){var e=this;this.setState({URLlogin:this.props.curr_login}),fetch("/profile",{method:"POST",headers:Object(M.a)(),body:JSON.stringify({login:this.props.curr_login})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState((function(e){return e.userInfo=t,e}))}))}},{key:"componentDidMount",value:function(){this.getInfo()}},{key:"componentDidUpdate",value:function(e){e.curr_login!==this.props.curr_login&&this.getInfo()}},{key:"render",value:function(){return c.a.createElement(b.a,{className:"col-12 mt-3 mt-lg-0 p-lg-4"},c.a.createElement(S.a,null,c.a.createElement(C.a,{className:"col-12 col-lg-4"},c.a.createElement(he,{userInfo:this.state.userInfo}),this.props.curr_login===this.props.user.login&&c.a.createElement(ge,null)),c.a.createElement(C.a,{className:"col-12 col-lg-8"},(this.props.curr_login===this.props.user.login||"admin"===this.props.user.role||"student"===this.props.user.role)&&c.a.createElement(fe,{curr_login:this.props.curr_login}))))}}]),a}(l.Component),Ee=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{onSignOut:function(t){e(f(t))}}}))(be),ve=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return c.a.createElement(Ee,{curr_login:this.props.match.params.curr_login})}}]),a}(l.Component),Oe=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleOnChange=n.handleOnChange.bind(Object(j.a)(n)),n.handleOnClick=n.handleOnClick.bind(Object(j.a)(n)),n.handleVerify=n.handleVerify.bind(Object(j.a)(n)),n.handleFullVerify=n.handleFullVerify.bind(Object(j.a)(n)),n.state={values:{email:"",login:"",name:"",surname:"",patronymic:"",GithubLogin:"",MoodleLogin:""},errors:{login:!1,email:!1,name:!1,surname:!1,patronymic:"",GithubLogin:!1,MoodleLogin:!1},rules:{email:[function(e){return!e||-1!==e.search(/^(([a-z0-9_-]+\.)*[a-z0-9_-]+@[a-z0-9_-]+(\.[a-z0-9_-]+)*\.[a-z]{2,6})$/g)||"\u0424\u043e\u0440\u043c\u0430\u0442 \u043f\u043e\u0447\u0442\u044b \u043d\u0435 \u0432\u0435\u0440\u043d\u044b\u0439"}],login:[function(e){return!e||e.length>5||"\u041b\u043e\u0433\u0438\u043d \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0434\u043b\u0438\u043d\u043d\u0435\u0435 5 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432."},function(e){return!e||-1!==e.search(/^[a-zA-Z0-9_-]*$/)||"\u041b\u043e\u0433\u0438\u043d \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b _ - 0-9 a-z A-Z."},function(e){return!e||-1!==e.search(/^[a-zA-Z]/)||"\u041b\u043e\u0433\u0438\u043d \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0441\u0438\u043c\u0432\u043e\u043b\u044b a-z A-Z."}],name:[function(e){return!e||-1!==e.search(/^[\u0430-\u044f\u0410-\u042fa-zA-Z]+$/)||"\u0418\u043c\u044f \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b - \u0430-\u044f \u0410-\u042f a-z A-Z"}],surname:[function(e){return!e||-1!==e.search(/^[\u0430-\u044f\u0410-\u042fa-zA-Z]+$/)||"\u0424\u0430\u043c\u0438\u043b\u0438\u044f \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b - \u0430-\u044f \u0410-\u042f a-z A-Z"}],patronymic:[function(e){return!e||-1!==e.search(/^[\u0430-\u044f\u0410-\u042fa-zA-Z]+$/)||"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b - \u0430-\u044f \u0410-\u042f a-z A-Z"}],GithubLogin:[function(e){return!e||-1!==e.search(/^[a-zA-Z0-9_-]*$/)||"GithubLogin \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b _ - 0-9 a-z A-Z."},function(e){return!e||-1!==e.search(/^[a-zA-Z]/)||"GithubLogin \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0441\u0438\u043c\u0432\u043e\u043b\u044b a-z A-Z."}],MoodleLogin:[function(e){return!e||-1!==e.search(/^[a-zA-Z0-9_-]*$/)||"MoodleLogin \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b _ - 0-9 a-z A-Z."},function(e){return!e||-1!==e.search(/^[a-zA-Z]/)||"MoodleLogin \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0441\u0438\u043c\u0432\u043e\u043b\u044b a-z A-Z."}]}},n}return Object(i.a)(a,[{key:"handleOnChange",value:function(e){var t=e.target.name,a=e.target.value;this.setState((function(e){return e.values[t]=a,e})),this.handleVerify(t,a)}},{key:"handleVerify",value:function(e,t){this.setState((function(a){var n=a.rules[e].map((function(e){var a=e(t);return!0!==a?a:null})).filter((function(e){return null!==e})).map((function(e){return c.a.createElement("p",{className:"p-0 m-0"},e)}));return a.errors[e]=0!==n.length&&n,a}))}},{key:"handleFullVerify",value:function(){var e=Object(N.a)(O.a.mark((function e(){var t=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object.entries(this.state.values).forEach((function(e){var a=Object(y.a)(e,2),n=a[0],r=a[1];t.handleVerify(n,r)}));case 2:return console.log(JSON.stringify(this.state.errors)),e.abrupt("return",Object.values(this.state.errors).every((function(e){return!e})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleOnClick",value:function(){var e=this;this.handleFullVerify().then((function(t){t&&fetch("/profile/editor/updateinfo",{method:"POST",headers:Object(M.a)(),body:JSON.stringify({user_id:e.props.user.id,newData:Object(E.a)({},e.state.values)})}).then((function(e){return e.json()})).then((function(t){!0===t.success&&e.props.onInfoUpd(t.newInfo),console.log(t)}))}))}},{key:"render",value:function(){return c.a.createElement(b.a,{className:"m-3 p-0 col-12"},c.a.createElement(b.a,{className:"custom-paper p-3 bg-light"},c.a.createElement(C.a,{className:"col-12 m-2 d-flex flex-column align-items-center"},c.a.createElement("h5",null," \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c")),c.a.createElement(C.a,null,c.a.createElement(S.a,null,c.a.createElement("p",{className:"mb-0"},"\u0421\u0435\u0439\u0447\u0430\u0441 \u0424\u0418\u041e: ",c.a.createElement("b",null," ",this.props.userInfo.name," ",this.props.userInfo.surname," ",this.props.userInfo.patronymic)),c.a.createElement(w.a,{className:"mb-3"},c.a.createElement(w.a.Prepend,null,c.a.createElement(w.a.Text,{className:"custom-form"},"\u041d\u043e\u0432\u043e\u0435 \u0418\u043c\u044f")),c.a.createElement(L.a,{isInvalid:!!this.state.errors.name,name:"name",value:this.state.values.name,onChange:this.handleOnChange,type:"text",placeholder:"\u041d\u043e\u0432\u043e\u0435 \u0438\u043c\u044f",className:"custom-endform"}),c.a.createElement(L.a.Feedback,{type:"invalid"},this.state.errors.name)),c.a.createElement(w.a,{className:"mb-3"},c.a.createElement(w.a.Prepend,null,c.a.createElement(w.a.Text,{className:"custom-form"},"\u041d\u043e\u0432\u0430\u044f \u0424\u0430\u043c\u0438\u043b\u0438\u044f")),c.a.createElement(L.a,{isInvalid:!!this.state.errors.surname,name:"surname",value:this.state.values.surname,onChange:this.handleOnChange,type:"text",placeholder:"\u041d\u043e\u0432\u0430\u044f \u0444\u0430\u043c\u0438\u043b\u0438\u044f",className:"custom-endform"}),c.a.createElement(L.a.Feedback,{type:"invalid"},this.state.errors.surname)),c.a.createElement(w.a,{className:"mb-3"},c.a.createElement(w.a.Prepend,null,c.a.createElement(w.a.Text,{className:"custom-form"},"\u041d\u043e\u0432\u043e\u0435 \u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e")),c.a.createElement(L.a,{isInvalid:!!this.state.errors.patronymic,name:"patronymic",value:this.state.values.patronymic,onChange:this.handleOnChange,type:"text",placeholder:"\u041d\u043e\u0432\u043e\u0435 \u043e\u0442\u0447\u0435\u0441\u0442\u0432\u043e",className:"custom-endform"}),c.a.createElement(L.a.Feedback,{type:"invalid"},this.state.errors.patronymic))),c.a.createElement(S.a,null,c.a.createElement("p",{className:"mb-0"},"\u0421\u0435\u0439\u0447\u0430\u0441 \u041f\u043e\u0447\u0442\u0430: ",c.a.createElement("b",null,this.props.userInfo.email)),c.a.createElement(w.a,{className:"mb-3"},c.a.createElement(w.a.Prepend,null,c.a.createElement(w.a.Text,{className:"custom-form"},"\u041d\u043e\u0432\u0430\u044f \u041f\u043e\u0447\u0442\u0430")),c.a.createElement(L.a,{isInvalid:!!this.state.errors.email,name:"email",value:this.state.values.email,onChange:this.handleOnChange,type:"email",placeholder:"\u041d\u043e\u0432\u0430\u044f \u043f\u043e\u0447\u0442\u0430",className:"custom-endform"}),c.a.createElement(L.a.Feedback,{type:"invalid"},this.state.errors.email))),c.a.createElement(S.a,null,c.a.createElement("p",{className:"mb-0"},"\u0421\u0435\u0439\u0447\u0430\u0441 \u041b\u043e\u0433\u0438\u043d: ",c.a.createElement("b",null,this.props.userInfo.login)," "),c.a.createElement(w.a,{className:"mb-3"},c.a.createElement(w.a.Prepend,null,c.a.createElement(w.a.Text,{className:"custom-form"},"\u041d\u043e\u0432\u044b\u0439 \u041b\u043e\u0433\u0438\u043d")),c.a.createElement(L.a,{isInvalid:!!this.state.errors.login,name:"login",value:this.state.values.login,onChange:this.handleOnChange,type:"text",placeholder:"\u041d\u043e\u0432\u044b\u0439 \u043b\u043e\u0433\u0438\u043d",className:"custom-endform"}),c.a.createElement(L.a.Feedback,{type:"invalid"},this.state.errors.login))),c.a.createElement(S.a,null,c.a.createElement("p",{className:"mb-0"},"\u0421\u0435\u0439\u0447\u0430\u0441 GithubLogin: ",c.a.createElement("b",null,this.props.userInfo.GithubLogin)),c.a.createElement(w.a,{className:"mb-3"},c.a.createElement(w.a.Prepend,null,c.a.createElement(w.a.Text,{className:"custom-form"},"\u041d\u043e\u0432\u044b\u0439 GithubLogin")),c.a.createElement(L.a,{isInvalid:!!this.state.errors.GithubLogin,name:"GithubLogin",value:this.state.values.GithubLogin,onChange:this.handleOnChange,type:"text",placeholder:"\u041d\u043e\u0432\u044b\u0439 GithubLogin",className:"custom-endform"}),c.a.createElement(L.a.Feedback,{type:"invalid"},this.state.errors.GithubLogin))),c.a.createElement(S.a,null,c.a.createElement("p",{className:"mb-0"},"\u0421\u0435\u0439\u0447\u0430\u0441 MoodleLogin: ",c.a.createElement("b",null," ",this.props.userInfo.MoodleLogin)," "),c.a.createElement(w.a,{className:"mb-3"},c.a.createElement(w.a.Prepend,null,c.a.createElement(w.a.Text,{className:"custom-form"},"\u041d\u043e\u0432\u044b\u0439 MoodleLogin")),c.a.createElement(L.a,{isInvalid:!!this.state.errors.MoodleLogin,name:"MoodleLogin",value:this.state.values.MoodleLogin,onChange:this.handleOnChange,type:"text",placeholder:"\u041d\u043e\u0432\u044b\u0439 MoodleLogin",className:"custom-endform"}),c.a.createElement(L.a.Feedback,{type:"invalid"},this.state.errors.MoodleLogin)))),c.a.createElement(d.b,{className:"btn icon-btn mr-3",to:"/profile/".concat(this.props.user.login)},c.a.createElement(G.a,{variant:"danger",className:"custom-btn mr-3 mb-2"},"\u041e\u0442\u043c\u0435\u043d\u0430")),c.a.createElement(d.b,{className:"btn icon-btn mr-3",to:"/profile/".concat(this.props.user.login)},c.a.createElement(G.a,{variant:"success",className:"custom-btn mr-3 mb-2",onClick:this.handleOnClick},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))))}}]),a}(l.Component),ye=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{onInfoUpd:function(t){e(g(t))}}}))(Oe),Ne=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).getInfo=n.getInfo.bind(Object(j.a)(n)),n.state={userInfo:{}},n}return Object(i.a)(a,[{key:"getInfo",value:function(){var e=this;fetch("/profile/editor/needinfo",{method:"POST",headers:Object(M.a)(),body:JSON.stringify({user_id:this.props.user.id})}).then((function(e){return e.json()})).then((function(t){t.error?console.error(t.error):e.setState({userInfo:t.userInfo})}))}},{key:"componentDidMount",value:function(){this.getInfo()}},{key:"render",value:function(){return c.a.createElement(ye,{userInfo:this.state.userInfo})}}]),a}(l.Component),je=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{}}))(Ne),Ce=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return c.a.createElement(je,null)}}]),a}(l.Component),ke=a(223),Se=a(222);a(118);var we=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{onSignOut:function(t){e(f(t))}}}))((function(e){return c.a.createElement(ke.a,{collapseOnSelect:!0,expand:"lg",variant:"light",className:"custom-nav"},c.a.createElement(d.b,{to:"/"},c.a.createElement(ke.a.Brand,{className:"p-0"},c.a.createElement(x.a,{src:"static/img/logo.png",width:"45",height:"45",className:"p-0 mr-3"}),c.a.createElement("b",{className:"custom-logoname mr-1"},"El Queue"))),c.a.createElement(ke.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),c.a.createElement(ke.a.Collapse,{id:"responsive-navbar-nav"},e.user.isAuth?c.a.createElement(c.a.Fragment,null,c.a.createElement(Se.a,{className:"mr-auto"},c.a.createElement(Se.a.Link,{className:"mr-2",href:"#/"},"\u041e\u0447\u0435\u0440\u0435\u0434\u0438"),"student"!==e.user.role&&c.a.createElement(Se.a.Link,{className:"mr-2",href:"#/addqueue"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043e\u0447\u0435\u0440\u0435\u0434\u044c"),"admin"===e.user.role&&c.a.createElement(Se.a.Link,{className:"mr-2",href:"#/admindb"},"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"),c.a.createElement(Se.a.Link,{className:"mr-2",href:"#/stats"},"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430")),c.a.createElement(Se.a,null,c.a.createElement(Se.a.Link,{href:"#/profile/".concat(e.user.login)},"\u041f\u0440\u043e\u0444\u0438\u043b\u044c: ",e.user.login))):c.a.createElement(c.a.Fragment,null,c.a.createElement(Se.a,{className:"mr-auto"}),c.a.createElement(Se.a,null,c.a.createElement(Se.a.Link,{href:"#/auth/signin"},"\u0412\u0445\u043e\u0434"),c.a.createElement(Se.a.Link,{href:"#/auth/signup"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")))))})),Le=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleSubmit=n.handleSubmit.bind(Object(j.a)(n)),n.handleFullVerify=n.handleFullVerify.bind(Object(j.a)(n)),n.handleVerify=n.handleVerify.bind(Object(j.a)(n)),n.handleOnChange=n.handleOnChange.bind(Object(j.a)(n)),n.state={values:{login:"",password:""},errors:{login:!1,password:!1},rules:{login:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d."}],password:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c."}]}},n}return Object(i.a)(a,[{key:"handleOnChange",value:function(e){var t=e.target.name,a=e.target.value;this.setState((function(e){return e.values[t]=a,e})),this.handleVerify(t,a)}},{key:"handleFullVerify",value:function(){var e=Object(N.a)(O.a.mark((function e(){var t=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object.entries(this.state.values).forEach((function(e){var a=Object(y.a)(e,2),n=a[0],r=a[1];"secretKey"===n&&"\u0421\u0442\u0443\u0434\u0435\u043d\u0442"===t.state.values.role||"group"===n&&"\u0421\u0442\u0443\u0434\u0435\u043d\u0442"!==t.state.values.role||t.handleVerify(n,r)}));case 2:return console.log(JSON.stringify(this.state.errors)),e.abrupt("return",Object.values(this.state.errors).every((function(e){return!e})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleVerify",value:function(e,t){this.setState((function(a){var n=a.rules[e].map((function(e){var a=e(t);return!0!==a?a:null})).filter((function(e){return null!==e})).map((function(e){return c.a.createElement("p",{className:"p-0 m-0"},e)}));return a.errors[e]=0!==n.length&&n,a}))}},{key:"handleSubmit",value:function(e){var t=this;this.handleFullVerify().then((function(a){a&&(fetch("/signin",{method:"POST",headers:{Authorization:"JWT "+localStorage.getItem("accesstoken"),"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(t.state.values)}).then((function(e){return e.json()})).then((function(e){console.log(e),e.isAuth?(t.props.onSignIn(e),window.location.hash="#/"):alert("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c")})),e.preventDefault())})),e.preventDefault()}},{key:"render",value:function(){var e=this;return c.a.createElement(b.a,{className:"col-12 col-lg-6 p-3 "},c.a.createElement(b.a,{className:"custom-paper bg-light p-3"},c.a.createElement("p",{className:"h5 mb-3 text-center"},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"),c.a.createElement(C.a,null,c.a.createElement(k.a,{onSubmit:this.handleSubmit},c.a.createElement(k.a.Group,{controlId:"formBasicLogin"},c.a.createElement(k.a.Label,null,"\u041b\u043e\u0433\u0438\u043d"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.login,name:"login",value:this.state.values.login,onChange:this.handleOnChange,type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d",className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.login),c.a.createElement(k.a.Text,{className:"text-muted"},"\u0412\u0430\u0448 \u043b\u043e\u0433\u0438\u043d \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u0442\u0440\u0435\u0442\u044c\u0438\u043c \u043b\u0438\u0446\u0430\u043c.")),c.a.createElement(k.a.Group,{controlId:"formBasicPassword"},c.a.createElement(k.a.Label,null,"\u041f\u0430\u0440\u043e\u043b\u044c"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.password,name:"password",value:this.state.values.password,onChange:this.handleOnChange,type:"password",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",className:"custom-textform",ref:function(t){return e.passwordInput=t}}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.password)),c.a.createElement(G.a,{variant:"primary",type:"submit",className:"custom-btn mr-3 mb-2"},"\u0412\u043e\u0439\u0442\u0438"),c.a.createElement(d.b,{className:"btn custom-btn icon-btn mr-3",to:"/auth/signup"},c.a.createElement(G.a,{variant:"secondary",className:"custom-btn mr-3 mb-2"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"))))))}}]),a}(l.Component),Ie=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{onSignIn:function(t){e(p(t))}}}))(Le),_e=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleGitLogIn=n.handleGitLogIn.bind(Object(j.a)(n)),n.state={},n}return Object(i.a)(a,[{key:"handleGitLogIn",value:function(){fetch("/githubauth",{mode:"no-cors"}).then((function(e){if(302===e.status)return e.json()})).then((function(e){document.location=e.auth_url}))}},{key:"render",value:function(){return c.a.createElement(b.a,{className:"col-12 col-lg-3 p-3 "},c.a.createElement(b.a,{className:"p-3 d-flex justify-content-center"},c.a.createElement(G.a,{className:"custom-btn bg-white text-secondary custom-block pr-3 pl-3",onClick:this.handleGitLogIn},c.a.createElement(x.a,{src:"static/img/profile/github.png",className:"mr-2",width:"30",height:"30"}),"\u0412\u043e\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 GitHub")))}}]),a}(l.Component),xe=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ie,null),c.a.createElement(_e,null))}}]),a}(l.Component),Ge=a(218),Ae=a(104),ze=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleSubmit=n.handleSubmit.bind(Object(j.a)(n)),n.handleFullVerify=n.handleFullVerify.bind(Object(j.a)(n)),n.handleVerify=n.handleVerify.bind(Object(j.a)(n)),n.handleOnChange=n.handleOnChange.bind(Object(j.a)(n)),n.state={values:{login:"",email:"",password1:"",password2:"",name:"",surname:"",role:e.curr_key&&e.curr_key.match(/^curr_key/)?"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c":"\u0421\u0442\u0443\u0434\u0435\u043d\u0442",group:"",secretKey:e.curr_key&&e.curr_key.match(/^curr_key/)?e.curr_key.replace(/curr_key/,""):"",GithubLogin:"",MoodleLogin:"",recaptcha:""},errors:{login:!1,email:!1,password1:!1,password2:!1,name:!1,surname:!1,role:!1,group:!1,secretKey:!1,GithubLogin:!1,MoodleLogin:!1,recaptcha:!1},rules:{email:[function(e){return-1!==e.search(/^([a-z0-9_-]+\.)*[a-z0-9_-]+@[a-z0-9_-]+(\.[a-z0-9_-]+)*\.[a-z]{2,6}$/g)||"\u0424\u043e\u0440\u043c\u0430\u0442 \u043f\u043e\u0447\u0442\u044b \u043d\u0435 \u0432\u0435\u0440\u043d\u044b\u0439"}],login:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d."},function(e){return e.length>5||"\u041b\u043e\u0433\u0438\u043d \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0434\u043b\u0438\u043d\u043d\u0435\u0435 5 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432."},function(e){return-1!==e.search(/^[a-zA-Z0-9_-]*$/)||"\u041b\u043e\u0433\u0438\u043d \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b _ - 0-9 a-z A-Z."},function(e){return-1!==e.search(/^[a-zA-Z]/)||"\u041b\u043e\u0433\u0438\u043d \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0441\u0438\u043c\u0432\u043e\u043b\u044b a-z A-Z."}],password1:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c."},function(e){return e.length>8||"\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0434\u043b\u0438\u043d\u043d\u0435\u0435 8 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432."},function(e){return-1!==e.search(/(?=.*[0-9])/g)||"\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0445\u043e\u0442\u044f \u0431\u044b \u043e\u0434\u043d\u0443 \u0446\u0438\u0444\u0440\u0443."},function(e){return-1!==e.search(/(?=.*[!@#$%^&*])/g)||"\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0445\u043e\u0442\u044f \u0431\u044b \u043e\u0434\u0438\u043d \u0441\u043f\u0435\u0446\u0438\u043c\u0432\u043e\u043b (!@#$%^&*)."},function(e){return-1!==e.search(/(?=.*[a-z])/g)||"\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0445\u043e\u0442\u044f \u0431\u044b \u043e\u0434\u043d\u0443 \u043b\u0430\u0442\u0438\u043d\u0441\u043a\u0443\u044e \u0431\u0443\u043a\u0432\u0443 \u0432 \u043d\u0438\u0436\u043d\u0435\u043c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0435."},function(e){return-1!==e.search(/(?=.*[A-Z])/g)||"\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0445\u043e\u0442\u044f \u0431\u044b \u043e\u0434\u043d\u0443 \u043b\u0430\u0442\u0438\u043d\u0441\u043a\u0443\u044e \u0431\u0443\u043a\u0432\u0443 \u0432 \u0432\u0435\u0440\u0445\u043d\u0435\u043c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0435."},function(e){return-1!==e.search(/[!@#$%^&*0-9a-zA-Z]/g)||"\u041f\u0430\u0440\u043e\u043b\u044c \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e !@#$%^&*0-9a-zA-Z."}],password2:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c."},function(e){return e===n.password1Input.value||"\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442."}],name:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f."},function(e){return-1!==e.search(/^[\u0430-\u044f\u0410-\u042fa-zA-Z]+$/)||"\u0418\u043c\u044f \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b - \u0430-\u044f \u0410-\u042f a-z A-Z"}],surname:[function(e){return-1!==e.search(/^[\u0430-\u044f\u0410-\u042fa-zA-Z]+$/)||"\u0424\u0430\u043c\u0438\u043b\u0438\u044f \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b - \u0430-\u044f \u0410-\u042f a-z A-Z"},function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f."}],role:[function(e){return!!e||"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0438\u043f."}],group:[function(e){return!!e||"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u0440\u0443\u043f\u043f\u0443."},function(e){return-1!==e.search(/^[0-9]{4}$/)||"\u0413\u0440\u0443\u043f\u043f\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 4 \u0446\u0438\u0444\u0440"}],secretKey:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043a\u043b\u044e\u0447."}],GithubLogin:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 GithubLogin."},function(e){return-1!==e.search(/^[a-zA-Z0-9_-]*$/)||"GithubLogin \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b _ - 0-9 a-z A-Z."},function(e){return-1!==e.search(/^[a-zA-Z]/)||"GithubLogin \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0441\u0438\u043c\u0432\u043e\u043b\u044b a-z A-Z."}],MoodleLogin:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 MoodleLogin."},function(e){return-1!==e.search(/^[a-zA-Z0-9_-]*$/)||"MoodleLogin \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b _ - 0-9 a-z A-Z."},function(e){return-1!==e.search(/^[a-zA-Z]/)||"MoodleLogin \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0441\u0438\u043c\u0432\u043e\u043b\u044b a-z A-Z."}],recaptcha:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 recaptcha."}]}},n}return Object(i.a)(a,[{key:"handleOnChange",value:function(e){var t=e.target.name,a=e.target.value;this.setState((function(e){return e.values[t]=a,e})),this.handleVerify(t,a)}},{key:"handleFullVerify",value:function(){var e=Object(N.a)(O.a.mark((function e(){var t=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object.entries(this.state.values).forEach((function(e){var a=Object(y.a)(e,2),n=a[0],r=a[1];"secretKey"===n&&"\u0421\u0442\u0443\u0434\u0435\u043d\u0442"===t.state.values.role||"group"===n&&"\u0421\u0442\u0443\u0434\u0435\u043d\u0442"!==t.state.values.role||t.handleVerify(n,r)}));case 2:return console.log(JSON.stringify(this.state.errors)),e.abrupt("return",Object.values(this.state.errors).every((function(e){return!e})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleVerify",value:function(e,t){this.setState((function(a){var n=a.rules[e].map((function(e){var a=e(t);return!0!==a?a:null})).filter((function(e){return null!==e})).map((function(e){return c.a.createElement("p",{className:"p-0 m-0"},e)}));return a.errors[e]=0!==n.length&&n,a}))}},{key:"handleSubmit",value:function(e){var t=this;console.log(this.state.values),this.handleFullVerify().then((function(e){e&&fetch("/signup",{method:"POST",headers:Object(M.a)(),body:JSON.stringify(Object(E.a)(Object(E.a)({},t.state.values),{},{regType:"USUAL"}))}).then((function(e){return e.json()})).then((function(e){console.log(e),e.isReg?window.location.hash="#/auth/signin":alert(e.causeOfError)}))})),e.preventDefault()}},{key:"render",value:function(){var e=this;return c.a.createElement(b.a,{className:"col-12 col-lg-6 p-3 "},c.a.createElement(b.a,{className:"custom-paper bg-light p-3"},c.a.createElement(C.a,null,c.a.createElement(k.a,{onSubmit:this.handleSubmit},c.a.createElement(k.a.Row,null,c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridLogin",className:"col-12 col-lg-6"},c.a.createElement(k.a.Label,null,"\u041b\u043e\u0433\u0438\u043d"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.login,name:"login",value:this.state.values.login,onChange:this.handleOnChange,type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d",className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.login)),c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridEmail",className:"col-12 col-lg-6"},c.a.createElement(k.a.Label,null,"\u041f\u043e\u0447\u0442\u0430"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.email,name:"email",value:this.state.values.email,onChange:this.handleOnChange,type:"email",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u043e\u0447\u0442\u0443",className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.email))),c.a.createElement(k.a.Row,null,c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridPassword1",className:"col-12 col-lg-6"},c.a.createElement(k.a.Label,null,"\u041f\u0430\u0440\u043e\u043b\u044c"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.password1,name:"password1",value:this.state.values.password1,onChange:this.handleOnChange,type:"password",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",className:"custom-textform",ref:function(t){return e.password1Input=t}}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.password1)),c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridPassword2",className:"col-12 col-lg-6"},c.a.createElement(k.a.Label,null,"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.password2,name:"password2",value:this.state.values.password2,onChange:this.handleOnChange,type:"password",placeholder:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.password2))),c.a.createElement(k.a.Row,null,c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridName",className:"col-12 col-lg-6"},c.a.createElement(k.a.Label,null,"\u0418\u043c\u044f"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.name,name:"name",value:this.state.values.name,onChange:this.handleOnChange,type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u043e\u043b\u043d\u043e\u0435 \u0438\u043c\u044f",className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.name)),c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridSurname",className:"col-12 col-lg-6"},c.a.createElement(k.a.Label,null,"\u0424\u0430\u043c\u0438\u043b\u0438\u044f"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.surname,name:"surname",value:this.state.values.surname,onChange:this.handleOnChange,type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0444\u0430\u043c\u0438\u043b\u0438\u044e",className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.surname))),c.a.createElement(k.a.Row,null,c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridRole"},c.a.createElement(k.a.Label,null,"\u0422\u0438\u043f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.role,name:"role",value:this.state.values.role,as:"select",className:"custom-select",onChange:function(t){var a=t.target.value;e.setState((function(e){return["\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c","\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440"].includes(e.role)&&["\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c","\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440"].includes(a)||(e.errors.secretKey=!1,e.errors.group=!1),e})),e.handleOnChange(t)}},c.a.createElement("option",{className:"custom-option"},"\u0421\u0442\u0443\u0434\u0435\u043d\u0442"),c.a.createElement("option",{className:"custom-option"},"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c"),c.a.createElement("option",{className:"custom-option"},"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440")),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.role))),"\u0421\u0442\u0443\u0434\u0435\u043d\u0442"===this.state.values.role&&c.a.createElement(k.a.Row,null,c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridGroup"},c.a.createElement(k.a.Label,null,"\u0413\u0440\u0443\u043f\u043f\u0430"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.group,name:"group",value:this.state.values.group,onChange:this.handleOnChange,className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.group))),c.a.createElement(k.a.Group,{controlId:"formGridSecretKey"},c.a.createElement(k.a.Label,null,"\u0421\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043a\u043e\u0434"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.secretKey,name:"secretKey",value:this.state.values.secretKey,onChange:this.handleOnChange,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043a\u043e\u0434",className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.secretKey)),c.a.createElement(k.a.Row,null,c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridGithubLogin"},c.a.createElement(k.a.Label,null,"GithubLogin"),c.a.createElement(k.a.Control,{className:"custom-textform",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 GithubLogin",isInvalid:!!this.state.errors.GithubLogin,name:"GithubLogin",value:this.state.values.GithubLogin,onChange:this.handleOnChange}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.GithubLogin)),c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridMoodleLogin"},c.a.createElement(k.a.Label,null,"MoodleLogin"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.MoodleLogin,name:"MoodleLogin",value:this.state.values.MoodleLogin,onChange:this.handleOnChange,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 MoodleLogin",className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.MoodleLogin))),c.a.createElement(k.a.Row,{className:"mb-3"},c.a.createElement(Ae.a,{sitekey:"6LctlLAZAAAAAHE2Zj-yKvioQcPNa1ZBOhqujNdK",onChange:function(t){e.setState((function(e){return e.values.recaptcha=t,e})),e.handleVerify("recaptcha",t)}}),this.state.errors.recaptcha&&c.a.createElement("label",null,this.state.errors.recaptcha)),c.a.createElement(G.a,{variant:"primary",type:"submit",className:"custom-btn mr-3 mb-2"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"),c.a.createElement(d.b,{className:"mr-3",to:"/auth/signin"},c.a.createElement(G.a,{variant:"secondary",className:"custom-btn mr-3 mb-2"},"\u0412\u0445\u043e\u0434"))))))}}]),a}(l.Component),Te=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleSubmit=n.handleSubmit.bind(Object(j.a)(n)),n.handleFullVerify=n.handleFullVerify.bind(Object(j.a)(n)),n.handleVerify=n.handleVerify.bind(Object(j.a)(n)),n.handleOnChange=n.handleOnChange.bind(Object(j.a)(n)),n.state={values:{email:e.email,login:"",name:"",surname:"",role:e.curr_key&&e.curr_key.match(/^curr_key/)?"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c":"\u0421\u0442\u0443\u0434\u0435\u043d\u0442",group:"",secretKey:e.curr_key&&e.curr_key.match(/^curr_key/)?e.curr_key.replace(/curr_key/,""):"",GithubLogin:e.gitLogin,GithubId:e.gitId,MoodleLogin:"",recaptcha:""},errors:{email:!1,login:!1,name:!1,surname:!1,role:!1,group:!1,secretKey:!1,MoodleLogin:!1,recaptcha:!1},rules:{email:[function(e){return-1!==e.search(/^([a-z0-9_-]+\.)*[a-z0-9_-]+@[a-z0-9_-]+(\.[a-z0-9_-]+)*\.[a-z]{2,6}$/g)||"\u0424\u043e\u0440\u043c\u0430\u0442 \u043f\u043e\u0447\u0442\u044b \u043d\u0435 \u0432\u0435\u0440\u043d\u044b\u0439"}],login:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d."},function(e){return e.length>5||"\u041b\u043e\u0433\u0438\u043d \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0434\u043b\u0438\u043d\u043d\u0435\u0435 5 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432."},function(e){return-1!==e.search(/^[a-zA-Z0-9_-]*$/)||"\u041b\u043e\u0433\u0438\u043d \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b _ - 0-9 a-z A-Z."},function(e){return-1!==e.search(/^[a-zA-Z]/)||"\u041b\u043e\u0433\u0438\u043d \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0441\u0438\u043c\u0432\u043e\u043b\u044b a-z A-Z."}],name:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f."},function(e){return-1!==e.search(/^[\u0430-\u044f\u0410-\u042fa-zA-Z]+$/)||"\u0418\u043c\u044f \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b - \u0430-\u044f \u0410-\u042f a-z A-Z"}],surname:[function(e){return-1!==e.search(/^[\u0430-\u044f\u0410-\u042fa-zA-Z]+$/)||"\u0424\u0430\u043c\u0438\u043b\u0438\u044f \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b - \u0430-\u044f \u0410-\u042f a-z A-Z"},function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f."}],role:[function(e){return!!e||"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0438\u043f."}],group:[function(e){return!!e||"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u0440\u0443\u043f\u043f\u0443."}],secretKey:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043a\u043b\u044e\u0447."}],MoodleLogin:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 MoodleLogin."},function(e){return-1!==e.search(/^[a-zA-Z0-9_-]*$/)||"MoodleLogin \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b _ - 0-9 a-z A-Z."},function(e){return-1!==e.search(/^[a-zA-Z]/)||"MoodleLogin \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0441\u0438\u043c\u0432\u043e\u043b\u044b a-z A-Z."}],recaptcha:[function(e){return!!e||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 recaptcha."}]}},n}return Object(i.a)(a,[{key:"handleOnChange",value:function(e){console.log(e);var t=e.target.name,a=e.target.value;this.setState((function(e){return e.values[t]=a,e})),this.handleVerify(t,a)}},{key:"handleFullVerify",value:function(){var e=Object(N.a)(O.a.mark((function e(){var t=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object.keys(this.state.errors).forEach((function(e){"secretKey"===e&&"\u0421\u0442\u0443\u0434\u0435\u043d\u0442"===t.state.values.role||"group"===e&&"\u0421\u0442\u0443\u0434\u0435\u043d\u0442"!==t.state.values.role||t.handleVerify(e,t.state.values[e])}));case 2:return console.log(JSON.stringify(this.state.errors)),e.abrupt("return",Object.values(this.state.errors).every((function(e){return!e})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleVerify",value:function(e,t){this.setState((function(a){var n=a.rules[e].map((function(e){var a=e(t);return!0!==a?a:null})).filter((function(e){return null!==e})).map((function(e){return c.a.createElement("p",{className:"p-0 m-0"},e)}));return a.errors[e]=0!==n.length&&n,a}))}},{key:"handleSubmit",value:function(e){var t=this;console.log(this.state.values),this.handleFullVerify().then((function(e){e&&fetch("/signup",{method:"POST",headers:Object(M.a)(),body:JSON.stringify(Object(E.a)(Object(E.a)({},t.state.values),{},{regType:"GIT"}))}).then((function(e){return e.json()})).then((function(e){console.log(e),e.isReg?window.location.hash="#/auth/signin":alert(e.causeOfError)}))})),e.preventDefault()}},{key:"render",value:function(){var e=this;return c.a.createElement(b.a,{className:"col-12 col-lg-6 p-3 "},c.a.createElement(b.a,{className:"custom-paper bg-light p-3"},c.a.createElement(C.a,null,c.a.createElement(k.a,{onSubmit:this.handleSubmit},c.a.createElement(k.a.Row,null,c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridLogin",className:"col-12 col-lg-6"},c.a.createElement(k.a.Label,null,"\u041b\u043e\u0433\u0438\u043d"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.login,name:"login",value:this.state.values.login,onChange:this.handleOnChange,type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d",className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.login)),c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridEmail",className:"col-12 col-lg-6"},c.a.createElement(k.a.Label,null,"\u041f\u043e\u0447\u0442\u0430"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.email,name:"email",value:this.state.values.email,onChange:this.handleOnChange,type:"email",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u043e\u0447\u0442\u0443",className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.email))),c.a.createElement(k.a.Row,null,c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridName",className:"col-12 col-lg-6"},c.a.createElement(k.a.Label,null,"\u0418\u043c\u044f"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.name,name:"name",value:this.state.values.name,onChange:this.handleOnChange,type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u043e\u043b\u043d\u043e\u0435 \u0438\u043c\u044f",className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.name)),c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridSurname",className:"col-12 col-lg-6"},c.a.createElement(k.a.Label,null,"\u0424\u0430\u043c\u0438\u043b\u0438\u044f"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.surname,name:"surname",value:this.state.values.surname,onChange:this.handleOnChange,type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0444\u0430\u043c\u0438\u043b\u0438\u044e",className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.surname))),c.a.createElement(k.a.Row,null,c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridRole"},c.a.createElement(k.a.Label,null,"\u0422\u0438\u043f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.role,name:"role",value:this.state.values.role,as:"select",className:"custom-select",onChange:function(t){var a=t.target.value;e.setState((function(e){return["\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c","\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440"].includes(e.role)&&["\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c","\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440"].includes(a)||(e.errors.secretKey=!1,e.errors.group=!1),e})),e.handleOnChange(t)}},c.a.createElement("option",{className:"custom-option"},"\u0421\u0442\u0443\u0434\u0435\u043d\u0442"),c.a.createElement("option",{className:"custom-option"},"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c"),c.a.createElement("option",{className:"custom-option"},"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440")),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.role))),"\u0421\u0442\u0443\u0434\u0435\u043d\u0442"===this.state.values.role&&c.a.createElement(k.a.Row,null,c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridGroup"},c.a.createElement(k.a.Label,null,"\u0413\u0440\u0443\u043f\u043f\u0430"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.group,name:"group",value:this.state.values.group,onChange:this.handleOnChange,className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.group))),c.a.createElement(k.a.Group,{controlId:"formGridSecretKey"},c.a.createElement(k.a.Label,null,"\u0421\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043a\u043e\u0434"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.secretKey,name:"secretKey",value:this.state.values.secretKey,onChange:this.handleOnChange,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043a\u043e\u0434"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.secretKey)),c.a.createElement(k.a.Row,null,c.a.createElement(k.a.Group,{as:C.a,controlId:"formGridMoodleLogin"},c.a.createElement(k.a.Label,null,"MoodleLogin"),c.a.createElement(k.a.Control,{isInvalid:!!this.state.errors.MoodleLogin,name:"MoodleLogin",value:this.state.values.MoodleLogin,onChange:this.handleOnChange,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 MoodleLogin",className:"custom-textform"}),c.a.createElement(k.a.Control.Feedback,{type:"invalid"},this.state.errors.MoodleLogin))),c.a.createElement(k.a.Row,null,c.a.createElement(Ae.a,{sitekey:"6LctlLAZAAAAAHE2Zj-yKvioQcPNa1ZBOhqujNdK",onChange:function(t){e.setState((function(e){return e.values.recaptcha=t,e})),e.handleVerify("recaptcha",t)}}),this.state.errors.recaptcha&&c.a.createElement("label",null,this.state.errors.recaptcha)),c.a.createElement(G.a,{variant:"primary",type:"submit",className:"custom-btn mr-3 mb-2"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"),c.a.createElement(d.b,{className:"btn icon-btn mr-3",to:"/auth/signin"},c.a.createElement(G.a,{variant:"primary",className:"custom-btn mr-3 mb-2"},"\u0412\u0445\u043e\u0434"))))))}}]),a}(l.Component),Me=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleGitChecker=n.handleGitChecker.bind(Object(j.a)(n)),n.state={currForm:c.a.createElement(c.a.Fragment,null,c.a.createElement(ze,{curr_key:n.props.curr_key}),c.a.createElement(_e,null))},n}return Object(i.a)(a,[{key:"handleGitChecker",value:function(){var e=this,t=window.location.search,a=new URLSearchParams(t).get("code");a&&(this.setState({currForm:c.a.createElement(b.a,{className:"d-flex justify-content-center m-5 p-5"},c.a.createElement(Y.a,{animation:"border"}))}),window.history.pushState({},null,"/"+window.location.hash),fetch("/authenticate",{method:"POST",headers:Object(M.a)(),body:JSON.stringify({code:a})}).then((function(e){return e.json()})).then((function(t){console.log(t),t.error?(console.error(t.error),e.setState({currForm:c.a.createElement(b.a,{className:"col-12 col-lg-6 p-3 "},c.a.createElement(Ge.a,{variant:"danger"},"\u041e\u0448\u0438\u0431\u043a\u0430: ",t.error,". \u041d\u0430\u0436\u043c\u0438\u0442\u0435",c.a.createElement(Ge.a.Link,{href:"#/auth/signin"}," \u0442\u0443\u0442 "),"\u0447\u0442\u043e\u0431\u044b \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438."))})):t.needReg?e.setState({currForm:c.a.createElement(Te,{email:t.email,gitLogin:t.gitLogin,gitId:t.gitId})}):t.isAuth&&(delete t.needReg,fetch("/signin",{method:"POST",headers:{Authorization:"JWT "+localStorage.getItem("accesstoken"),"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({login:t.login,password:"github"})}).then((function(e){return e.json()})).then((function(t){console.log("SSS"+t),t.isAuth?(e.props.onSignIn(t),window.location.hash="#/"):alert(t.causeOfError)})))})))}},{key:"componentDidMount",value:function(){this.handleGitChecker()}},{key:"render",value:function(){return this.state.currForm}}]),a}(l.Component),Fe=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{onSignIn:function(t){e(p(t))}}}))(Me),Ve=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return console.log("111111111111"),c.a.createElement(c.a.Fragment,null,c.a.createElement(Fe,null))}}]),a}(l.Component),De=a(224);var Qe=function(e){var t=Object(l.useState)(!0),a=Object(y.a)(t,2),n=a[0],r=a[1];return c.a.createElement(S.a,null,c.a.createElement(C.a,{xs:6},c.a.createElement(De.a,{onClose:function(){r(!1)},className:"custom-paper m-3",show:n,delay:3e3,autohide:!0},c.a.createElement(De.a.Header,null,c.a.createElement("img",{className:"rounded mr-2",alt:""}),c.a.createElement("strong",{className:"mr-auto"},e.head),c.a.createElement("small",null,e.type)),c.a.createElement(De.a.Body,null,c.a.createElement(C.a,null,e.message,c.a.createElement(S.a,null,e.tags&&e.tags.map((function(e,t){return c.a.createElement("span",{key:"nottag_"+t,className:"badge badge-secondary custom-badge mr-1 mb-1"},e)})),e.link&&c.a.createElement("a",{href:e.link,className:"btn custom-btn icon-btn mr-3"},c.a.createElement(x.a,{src:"static/img/arrowRight.svg",width:"28"}))))))))},Ze=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={notifications:[],count:0},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;K.on("notification",(function(t){e.setState((function(e){return e.notifications.unshift(c.a.createElement(Qe,{key:"Notification"+e.count,type:t.type||!1,message:t.message||!1,tags:t.tags||!1,link:t.link||!1,head:t.head||!1})),e.count++,e}));var a=setTimeout((function(){e.setState((function(e){return e.notifications.pop(),e})),clearTimeout(a)}),3500)}))}},{key:"componentWillUnmount",value:function(){K.removeAllListeners("notification")}},{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,this.state.notifications)}}]),a}(l.Component),Re=c.a.lazy((function(){return Promise.all([a.e(2),a.e(5)]).then(a.bind(null,793))})),Pe=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return c.a.createElement(d.a,{basename:"/"},c.a.createElement(we,null),this.props.user.isAuth?c.a.createElement(h.d,null,c.a.createElement(h.b,{exact:!0,path:"/"},c.a.createElement(B,null)),"student"!==this.props.user.role&&c.a.createElement(h.b,{path:"/addqueue",component:Q}),c.a.createElement(h.b,{path:"/queue/:curr_id",component:ue}),c.a.createElement(h.b,{path:"/profile/editor/",component:Ce}),c.a.createElement(h.b,{path:"/profile/:curr_login",component:ve}),c.a.createElement(h.b,{path:"/stats",component:me}),c.a.createElement(h.b,{path:"/admindb"},"admin"===this.props.user.role&&c.a.createElement(l.Suspense,{fallback:c.a.createElement("div",null)},c.a.createElement(Re,null))),c.a.createElement(h.a,{strict:!0,to:"/"})):c.a.createElement(c.a.Fragment,null,c.a.createElement(h.d,null,c.a.createElement(h.b,{exact:!0,path:"/"},c.a.createElement(h.a,{strict:!0,to:"auth/signin"})),c.a.createElement(h.b,{path:"/auth/signin",component:xe}),c.a.createElement(h.b,{path:"/auth/signup/:curr_key",component:Ve}),c.a.createElement(h.b,{path:"/auth/signup/",component:Ve}),c.a.createElement(h.a,{strict:!0,to:"/"}))),c.a.createElement(Ze,null))}}]),a}(l.Component),qe=Object(n.b)((function(e){return{user:e.user}}),(function(e){return{onLocalAuthCheck:function(t){e(function(e){return function(t){t({type:"AUTH_CHECK",data:e})}}(t))},onInfoUpdate:function(t){e(g(t))},onSignOut:function(t){e(f(t))}}}))(Pe);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Je=a(105);s.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(n.a,{store:Je.a},c.a.createElement(qe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[161,1,3]]]);
//# sourceMappingURL=main.ea7eb585.chunk.js.map